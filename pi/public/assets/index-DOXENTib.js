(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=i(l);fetch(l.href,o)}})();const ya=!0,Pe="u-",wa="uplot",Sa=Pe+"hz",xa=Pe+"vt",ka=Pe+"title",Ma=Pe+"wrap",La=Pe+"under",Aa=Pe+"over",Ta=Pe+"axis",rn=Pe+"off",Ea=Pe+"select",Ia=Pe+"cursor-x",Da=Pe+"cursor-y",Ba=Pe+"cursor-pt",Pa=Pe+"legend",za=Pe+"live",Ca=Pe+"inline",$a=Pe+"series",Oa=Pe+"marker",Ns=Pe+"label",Ra=Pe+"value",ei="width",ti="height",Zn="top",Hs="bottom",In="left",hl="right",Nl="#000",Fs=Nl+"0",pl="mousemove",Us="mousedown",ml="mouseup",Vs="mouseenter",Ws="mouseleave",js="dblclick",Na="resize",Ha="scroll",Gs="change",Ti="dppxchange",Hl="--",Hn=typeof window<"u",kl=Hn?document:null,zn=Hn?window:null,Fa=Hn?navigator:null;let ue,wi;function Ml(){let e=devicePixelRatio;ue!=e&&(ue=e,wi&&Al(Gs,wi,Ml),wi=matchMedia(`(min-resolution: ${ue-.001}dppx) and (max-resolution: ${ue+.001}dppx)`),on(Gs,wi,Ml),zn.dispatchEvent(new CustomEvent(Ti)))}function st(e,t){if(t!=null){let i=e.classList;!i.contains(t)&&i.add(t)}}function Ll(e,t){let i=e.classList;i.contains(t)&&i.remove(t)}function ye(e,t,i){e.style[t]=i+"px"}function St(e,t,i,n){let l=kl.createElement(e);return t!=null&&st(l,t),i!=null&&i.insertBefore(l,n),l}function pt(e,t){return St("div",e,t)}const Ks=new WeakMap;function Pt(e,t,i,n,l){let o="translate("+t+"px,"+i+"px)",a=Ks.get(e);o!=a&&(e.style.transform=o,Ks.set(e,o),t<0||i<0||t>n||i>l?st(e,rn):Ll(e,rn))}const qs=new WeakMap;function Ys(e,t,i){let n=t+i,l=qs.get(e);n!=l&&(qs.set(e,n),e.style.background=t,e.style.borderColor=i)}const Js=new WeakMap;function Qs(e,t,i,n){let l=t+""+i,o=Js.get(e);l!=o&&(Js.set(e,l),e.style.height=i+"px",e.style.width=t+"px",e.style.marginLeft=n?-t/2+"px":0,e.style.marginTop=n?-i/2+"px":0)}const Fl={passive:!0},Ua={...Fl,capture:!0};function on(e,t,i,n){t.addEventListener(e,i,n?Ua:Fl)}function Al(e,t,i,n){t.removeEventListener(e,i,Fl)}Hn&&Ml();function xt(e,t,i,n){let l;i=i||0,n=n||t.length-1;let o=n<=2147483647;for(;n-i>1;)l=o?i+n>>1:rt((i+n)/2),t[l]<e?i=l:n=l;return e-t[i]<=t[n]-e?i:n}function zr(e){return(i,n,l)=>{let o=-1,a=-1;for(let g=n;g<=l;g++)if(e(i[g])){o=g;break}for(let g=l;g>=n;g--)if(e(i[g])){a=g;break}return[o,a]}}const Cr=e=>e!=null,$r=e=>e!=null&&e>0,Pi=zr(Cr),Va=zr($r);function Wa(e,t,i,n=0,l=!1){let o=l?Va:Pi,a=l?$r:Cr;[t,i]=o(e,t,i);let g=e[t],f=e[t];if(t>-1)if(n==1)g=e[t],f=e[i];else if(n==-1)g=e[i],f=e[t];else for(let h=t;h<=i;h++){let v=e[h];a(v)&&(v<g?g=v:v>f&&(f=v))}return[g??he,f??-he]}function zi(e,t,i,n){let l=er(e),o=er(t);e==t&&(l==-1?(e*=i,t/=i):(e/=i,t*=i));let a=i==10?Ot:Or,g=l==1?rt:mt,f=o==1?mt:rt,h=g(a(Be(e))),v=f(a(Be(t))),m=$n(i,h),b=$n(i,v);return i==10&&(h<0&&(m=pe(m,-h)),v<0&&(b=pe(b,-v))),n||i==2?(e=m*l,t=b*o):(e=Fr(e,m),t=Ci(t,b)),[e,t]}function Ul(e,t,i,n){let l=zi(e,t,i,n);return e==0&&(l[0]=0),t==0&&(l[1]=0),l}const Vl=.1,Zs={mode:3,pad:Vl},ii={pad:0,soft:null,mode:0},ja={min:ii,max:ii};function Ei(e,t,i,n){return $i(i)?Xs(e,t,i):(ii.pad=i,ii.soft=n?0:null,ii.mode=n?3:0,Xs(e,t,ja))}function ae(e,t){return e??t}function Ga(e,t,i){for(t=ae(t,0),i=ae(i,e.length-1);t<=i;){if(e[t]!=null)return!0;t++}return!1}function Xs(e,t,i){let n=i.min,l=i.max,o=ae(n.pad,0),a=ae(l.pad,0),g=ae(n.hard,-he),f=ae(l.hard,he),h=ae(n.soft,he),v=ae(l.soft,-he),m=ae(n.mode,0),b=ae(l.mode,0),M=t-e,S=Ot(M),T=Je(Be(e),Be(t)),$=Ot(T),F=Be($-S);(M<1e-24||F>10)&&(M=0,(e==0||t==0)&&(M=1e-24,m==2&&h!=he&&(o=0),b==2&&v!=-he&&(a=0)));let L=M||T||1e3,O=Ot(L),E=$n(10,rt(O)),Z=L*(M==0?e==0?.1:1:o),C=pe(Fr(e-Z,E/10),24),X=e>=h&&(m==1||m==3&&C<=h||m==2&&C>=h)?h:he,Y=Je(g,C<X&&e>=X?X:kt(X,C)),ne=L*(M==0?t==0?.1:1:a),q=pe(Ci(t+ne,E/10),24),I=t<=v&&(b==1||b==3&&q>=v||b==2&&q<=v)?v:-he,Q=kt(f,q>I&&t<=I?I:Je(I,q));return Y==Q&&Y==0&&(Q=100),[Y,Q]}const Ka=new Intl.NumberFormat(Hn?Fa.language:"en-US"),Wl=e=>Ka.format(e),ot=Math,Ai=ot.PI,Be=ot.abs,rt=ot.floor,De=ot.round,mt=ot.ceil,kt=ot.min,Je=ot.max,$n=ot.pow,er=ot.sign,Ot=ot.log10,Or=ot.log2,qa=(e,t=1)=>ot.sinh(e)*t,_l=(e,t=1)=>ot.asinh(e/t),he=1/0;function tr(e){return(Ot((e^e>>31)-(e>>31))|0)+1}function Tl(e,t,i){return kt(Je(e,t),i)}function Rr(e){return typeof e=="function"}function ie(e){return Rr(e)?e:()=>e}const Ya=()=>{},Nr=e=>e,Hr=(e,t)=>t,Ja=e=>null,nr=e=>!0,ir=(e,t)=>e==t,Qa=/\.\d*?(?=9{6,}|0{6,})/gm,cn=e=>{if(Vr(e)||Gt.has(e))return e;const t=`${e}`,i=t.match(Qa);if(i==null)return e;let n=i[0].length-1;if(t.indexOf("e-")!=-1){let[l,o]=t.split("e");return+`${cn(l)}e${o}`}return pe(e,n)};function ln(e,t){return cn(pe(cn(e/t))*t)}function Ci(e,t){return cn(mt(cn(e/t))*t)}function Fr(e,t){return cn(rt(cn(e/t))*t)}function pe(e,t=0){if(Vr(e))return e;let i=10**t,n=e*i*(1+Number.EPSILON);return De(n)/i}const Gt=new Map;function Ur(e){return((""+e).split(".")[1]||"").length}function si(e,t,i,n){let l=[],o=n.map(Ur);for(let a=t;a<i;a++){let g=Be(a),f=pe($n(e,a),g);for(let h=0;h<n.length;h++){let v=e==10?+`${n[h]}e${a}`:n[h]*f,m=(a>=0?0:g)+(a>=o[h]?0:o[h]),b=e==10?v:pe(v,m);l.push(b),Gt.set(b,m)}}return l}const li={},jl=[],On=[null,null],jt=Array.isArray,Vr=Number.isInteger,Za=e=>e===void 0;function lr(e){return typeof e=="string"}function $i(e){let t=!1;if(e!=null){let i=e.constructor;t=i==null||i==Object}return t}function Xa(e){return e!=null&&typeof e=="object"}const ec=Object.getPrototypeOf(Uint8Array),Wr="__proto__";function Rn(e,t=$i){let i;if(jt(e)){let n=e.find(l=>l!=null);if(jt(n)||t(n)){i=Array(e.length);for(let l=0;l<e.length;l++)i[l]=Rn(e[l],t)}else i=e.slice()}else if(e instanceof ec)i=e.slice();else if(t(e)){i={};for(let n in e)n!=Wr&&(i[n]=Rn(e[n],t))}else i=e;return i}function Te(e){let t=arguments;for(let i=1;i<t.length;i++){let n=t[i];for(let l in n)l!=Wr&&($i(e[l])?Te(e[l],Rn(n[l])):e[l]=Rn(n[l]))}return e}const tc=0,nc=1,ic=2;function lc(e,t,i){for(let n=0,l,o=-1;n<t.length;n++){let a=t[n];if(a>o){for(l=a-1;l>=0&&e[l]==null;)e[l--]=null;for(l=a+1;l<i&&e[l]==null;)e[o=l++]=null}}}function sc(e,t){if(ac(e)){let a=e[0].slice();for(let g=1;g<e.length;g++)a.push(...e[g].slice(1));return cc(a[0])||(a=oc(a)),a}let i=new Set;for(let a=0;a<e.length;a++){let f=e[a][0],h=f.length;for(let v=0;v<h;v++)i.add(f[v])}let n=[Array.from(i).sort((a,g)=>a-g)],l=n[0].length,o=new Map;for(let a=0;a<l;a++)o.set(n[0][a],a);for(let a=0;a<e.length;a++){let g=e[a],f=g[0];for(let h=1;h<g.length;h++){let v=g[h],m=Array(l).fill(void 0),b=t?t[a][h]:nc,M=[];for(let S=0;S<v.length;S++){let T=v[S],$=o.get(f[S]);T===null?b!=tc&&(m[$]=T,b==ic&&M.push($)):m[$]=T}lc(m,M,l),n.push(m)}}return n}const rc=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function oc(e){let t=e[0],i=t.length,n=Array(i);for(let o=0;o<n.length;o++)n[o]=o;n.sort((o,a)=>t[o]-t[a]);let l=[];for(let o=0;o<e.length;o++){let a=e[o],g=Array(i);for(let f=0;f<i;f++)g[f]=a[n[f]];l.push(g)}return l}function ac(e){let t=e[0][0],i=t.length;for(let n=1;n<e.length;n++){let l=e[n][0];if(l.length!=i)return!1;if(l!=t){for(let o=0;o<i;o++)if(l[o]!=t[o])return!1}}return!0}function cc(e,t=100){const i=e.length;if(i<=1)return!0;let n=0,l=i-1;for(;n<=l&&e[n]==null;)n++;for(;l>=n&&e[l]==null;)l--;if(l<=n)return!0;const o=Je(1,rt((l-n+1)/t));for(let a=e[n],g=n+o;g<=l;g+=o){const f=e[g];if(f!=null){if(f<=a)return!1;a=f}}return!0}const jr=["January","February","March","April","May","June","July","August","September","October","November","December"],Gr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Kr(e){return e.slice(0,3)}const uc=Gr.map(Kr),dc=jr.map(Kr),fc={MMMM:jr,MMM:dc,WWWW:Gr,WWW:uc};function Xn(e){return(e<10?"0":"")+e}function gc(e){return(e<10?"00":e<100?"0":"")+e}const hc={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>Xn(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>Xn(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>Xn(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return t==0?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>Xn(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>Xn(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>gc(e.getMilliseconds())};function Gl(e,t){t=t||fc;let i=[],n=/\{([a-z]+)\}|[^{]+/gi,l;for(;l=n.exec(e);)i.push(l[0][0]=="{"?hc[l[1]]:l[0]);return o=>{let a="";for(let g=0;g<i.length;g++)a+=typeof i[g]=="string"?i[g]:i[g](o,t);return a}}const pc=new Intl.DateTimeFormat().resolvedOptions().timeZone;function mc(e,t){let i;return t=="UTC"||t=="Etc/UTC"?i=new Date(+e+e.getTimezoneOffset()*6e4):t==pc?i=e:(i=new Date(e.toLocaleString("en-US",{timeZone:t})),i.setMilliseconds(e.getMilliseconds())),i}const qr=e=>e%1==0,Ii=[1,2,2.5,5],_c=si(10,-32,0,Ii),Yr=si(10,0,32,Ii),vc=Yr.filter(qr),sn=_c.concat(Yr),Kl=`
`,Jr="{YYYY}",sr=Kl+Jr,Qr="{M}/{D}",ni=Kl+Qr,Si=ni+"/{YY}",Zr="{aa}",bc="{h}:{mm}",Pn=bc+Zr,rr=Kl+Pn,or=":{ss}",de=null;function Xr(e){let t=e*1e3,i=t*60,n=i*60,l=n*24,o=l*30,a=l*365,f=(e==1?si(10,0,3,Ii).filter(qr):si(10,-3,0,Ii)).concat([t,t*5,t*10,t*15,t*30,i,i*5,i*10,i*15,i*30,n,n*2,n*3,n*4,n*6,n*8,n*12,l,l*2,l*3,l*4,l*5,l*6,l*7,l*8,l*9,l*10,l*15,o,o*2,o*3,o*4,o*6,a,a*2,a*5,a*10,a*25,a*50,a*100]);const h=[[a,Jr,de,de,de,de,de,de,1],[l*28,"{MMM}",sr,de,de,de,de,de,1],[l,Qr,sr,de,de,de,de,de,1],[n,"{h}"+Zr,Si,de,ni,de,de,de,1],[i,Pn,Si,de,ni,de,de,de,1],[t,or,Si+" "+Pn,de,ni+" "+Pn,de,rr,de,1],[e,or+".{fff}",Si+" "+Pn,de,ni+" "+Pn,de,rr,de,1]];function v(m){return(b,M,S,T,$,F)=>{let L=[],O=$>=a,E=$>=o&&$<a,Z=m(S),C=pe(Z*e,3),X=vl(Z.getFullYear(),O?0:Z.getMonth(),E||O?1:Z.getDate()),Y=pe(X*e,3);if(E||O){let ne=E?$/o:0,q=O?$/a:0,I=C==Y?C:pe(vl(X.getFullYear()+q,X.getMonth()+ne,1)*e,3),Q=new Date(De(I/e)),R=Q.getFullYear(),G=Q.getMonth();for(let V=0;I<=T;V++){let le=vl(R+q*V,G+ne*V,1),U=le-m(pe(le*e,3));I=pe((+le+U)*e,3),I<=T&&L.push(I)}}else{let ne=$>=l?l:$,q=rt(S)-rt(C),I=Y+q+Ci(C-Y,ne);L.push(I);let Q=m(I),R=Q.getHours()+Q.getMinutes()/i+Q.getSeconds()/n,G=$/n,V=b.axes[M]._space,le=F/V;for(;I=pe(I+$,e==1?0:3),!(I>T);)if(G>1){let U=rt(pe(R+G,6))%24,se=m(I).getHours()-U;se>1&&(se=-1),I-=se*n,R=(R+G)%24;let fe=L[L.length-1];pe((I-fe)/$,3)*le>=.7&&L.push(I)}else L.push(I)}return L}}return[f,h,v]}const[yc,wc,Sc]=Xr(1),[xc,kc,Mc]=Xr(.001);si(2,-53,53,[1]);function ar(e,t){return e.map(i=>i.map((n,l)=>l==0||l==8||n==null?n:t(l==1||i[8]==0?n:i[1]+n)))}function cr(e,t){return(i,n,l,o,a)=>{let g=t.find(S=>a>=S[0])||t[t.length-1],f,h,v,m,b,M;return n.map(S=>{let T=e(S),$=T.getFullYear(),F=T.getMonth(),L=T.getDate(),O=T.getHours(),E=T.getMinutes(),Z=T.getSeconds(),C=$!=f&&g[2]||F!=h&&g[3]||L!=v&&g[4]||O!=m&&g[5]||E!=b&&g[6]||Z!=M&&g[7]||g[1];return f=$,h=F,v=L,m=O,b=E,M=Z,C(T)})}}function Lc(e,t){let i=Gl(t);return(n,l,o,a,g)=>l.map(f=>i(e(f)))}function vl(e,t,i){return new Date(e,t,i)}function ur(e,t){return t(e)}const Ac="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function dr(e,t){return(i,n,l,o)=>o==null?Hl:t(e(n))}function Tc(e,t){let i=e.series[t];return i.width?i.stroke(e,t):i.points.width?i.points.stroke(e,t):null}function Ec(e,t){return e.series[t].fill(e,t)}const Ic={show:!0,live:!0,isolate:!1,mount:Ya,markers:{show:!0,width:2,stroke:Tc,fill:Ec,dash:"solid"},idx:null,idxs:null,values:[]};function Dc(e,t){let i=e.cursor.points,n=pt(),l=i.size(e,t);ye(n,ei,l),ye(n,ti,l);let o=l/-2;ye(n,"marginLeft",o),ye(n,"marginTop",o);let a=i.width(e,t,l);return a&&ye(n,"borderWidth",a),n}function Bc(e,t){let i=e.series[t].points;return i._fill||i._stroke}function Pc(e,t){let i=e.series[t].points;return i._stroke||i._fill}function zc(e,t){return e.series[t].points.size}const bl=[0,0];function Cc(e,t,i){return bl[0]=t,bl[1]=i,bl}function xi(e,t,i,n=!0){return l=>{l.button==0&&(!n||l.target==t)&&i(l)}}function yl(e,t,i,n=!0){return l=>{(!n||l.target==t)&&i(l)}}const $c={show:!0,x:!0,y:!0,lock:!1,move:Cc,points:{one:!1,show:Dc,size:zc,width:0,stroke:Pc,fill:Bc},bind:{mousedown:xi,mouseup:xi,click:xi,dblclick:xi,mousemove:yl,mouseleave:yl,mouseenter:yl},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,t,i,n,l)=>n-l,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},eo={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},ql=Te({},eo,{filter:Hr}),to=Te({},ql,{size:10}),no=Te({},eo,{show:!1}),Yl='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',io="bold "+Yl,lo=1.5,fr={show:!0,scale:"x",stroke:Nl,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:io,side:2,grid:ql,ticks:to,border:no,font:Yl,lineGap:lo,rotate:0},Oc="Value",Rc="Time",gr={show:!0,scale:"x",auto:!1,sorted:1,min:he,max:-he,idxs:[]};function Nc(e,t,i,n,l){return t.map(o=>o==null?"":Wl(o))}function Hc(e,t,i,n,l,o,a){let g=[],f=Gt.get(l)||0;i=a?i:pe(Ci(i,l),f);for(let h=i;h<=n;h=pe(h+l,f))g.push(Object.is(h,-0)?0:h);return g}function El(e,t,i,n,l,o,a){const g=[],f=e.scales[e.axes[t].scale].log,h=f==10?Ot:Or,v=rt(h(i));l=$n(f,v),f==10&&(l=sn[xt(l,sn)]);let m=i,b=l*f;f==10&&(b=sn[xt(b,sn)]);do g.push(m),m=m+l,f==10&&!Gt.has(m)&&(m=pe(m,Gt.get(l))),m>=b&&(l=m,b=l*f,f==10&&(b=sn[xt(b,sn)]));while(m<=n);return g}function Fc(e,t,i,n,l,o,a){let f=e.scales[e.axes[t].scale].asinh,h=n>f?El(e,t,Je(f,i),n,l):[f],v=n>=0&&i<=0?[0]:[];return(i<-f?El(e,t,Je(f,-n),-i,l):[f]).reverse().map(b=>-b).concat(v,h)}const so=/./,Uc=/[12357]/,Vc=/[125]/,hr=/1/,Il=(e,t,i,n)=>e.map((l,o)=>t==4&&l==0||o%n==0&&i.test(l.toExponential()[l<0?1:0])?l:null);function Wc(e,t,i,n,l){let o=e.axes[i],a=o.scale,g=e.scales[a],f=e.valToPos,h=o._space,v=f(10,a),m=f(9,a)-v>=h?so:f(7,a)-v>=h?Uc:f(5,a)-v>=h?Vc:hr;if(m==hr){let b=Be(f(1,a)-v);if(b<h)return Il(t.slice().reverse(),g.distr,m,mt(h/b)).reverse()}return Il(t,g.distr,m,1)}function jc(e,t,i,n,l){let o=e.axes[i],a=o.scale,g=o._space,f=e.valToPos,h=Be(f(1,a)-f(2,a));return h<g?Il(t.slice().reverse(),3,so,mt(g/h)).reverse():t}function Gc(e,t,i,n){return n==null?Hl:t==null?"":Wl(t)}const pr={show:!0,scale:"y",stroke:Nl,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:io,side:3,grid:ql,ticks:to,border:no,font:Yl,lineGap:lo,rotate:0};function Kc(e,t){let i=3+(e||1)*2;return pe(i*t,3)}function qc(e,t){let{scale:i,idxs:n}=e.series[0],l=e._data[0],o=e.valToPos(l[n[0]],i,!0),a=e.valToPos(l[n[1]],i,!0),g=Be(a-o),f=e.series[t],h=g/(f.points.space*ue);return n[1]-n[0]<=h}const mr={scale:null,auto:!0,sorted:0,min:he,max:-he},ro=(e,t,i,n,l)=>l,_r={show:!0,auto:!0,sorted:0,gaps:ro,alpha:1,facets:[Te({},mr,{scale:"x"}),Te({},mr,{scale:"y"})]},vr={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:ro,alpha:1,points:{show:qc,filter:null},values:null,min:he,max:-he,idxs:[],path:null,clip:null};function Yc(e,t,i,n,l){return i/10}const oo={time:ya,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Jc=Te({},oo,{time:!1,ori:1}),br={};function ao(e,t){let i=br[e];return i||(i={key:e,plots:[],sub(n){i.plots.push(n)},unsub(n){i.plots=i.plots.filter(l=>l!=n)},pub(n,l,o,a,g,f,h){for(let v=0;v<i.plots.length;v++)i.plots[v]!=l&&i.plots[v].pub(n,l,o,a,g,f,h)}},e!=null&&(br[e]=i)),i}const Nn=1,Dl=2;function un(e,t,i){const n=e.mode,l=e.series[t],o=n==2?e._data[t]:e._data,a=e.scales,g=e.bbox;let f=o[0],h=n==2?o[1]:o[t],v=n==2?a[l.facets[0].scale]:a[e.series[0].scale],m=n==2?a[l.facets[1].scale]:a[l.scale],b=g.left,M=g.top,S=g.width,T=g.height,$=e.valToPosH,F=e.valToPosV;return v.ori==0?i(l,f,h,v,m,$,F,b,M,S,T,Ri,Fn,Hi,uo,go):i(l,f,h,v,m,F,$,M,b,T,S,Ni,Un,Zl,fo,ho)}function Jl(e,t){let i=0,n=0,l=ae(e.bands,jl);for(let o=0;o<l.length;o++){let a=l[o];a.series[0]==t?i=a.dir:a.series[1]==t&&(a.dir==1?n|=1:n|=2)}return[i,n==1?-1:n==2?1:n==3?2:0]}function Qc(e,t,i,n,l){let o=e.mode,a=e.series[t],g=o==2?a.facets[1].scale:a.scale,f=e.scales[g];return l==-1?f.min:l==1?f.max:f.distr==3?f.dir==1?f.min:f.max:0}function Rt(e,t,i,n,l,o){return un(e,t,(a,g,f,h,v,m,b,M,S,T,$)=>{let F=a.pxRound;const L=h.dir*(h.ori==0?1:-1),O=h.ori==0?Fn:Un;let E,Z;L==1?(E=i,Z=n):(E=n,Z=i);let C=F(m(g[E],h,T,M)),X=F(b(f[E],v,$,S)),Y=F(m(g[Z],h,T,M)),ne=F(b(o==1?v.max:v.min,v,$,S)),q=new Path2D(l);return O(q,Y,ne),O(q,C,ne),O(q,C,X),q})}function Oi(e,t,i,n,l,o){let a=null;if(e.length>0){a=new Path2D;const g=t==0?Hi:Zl;let f=i;for(let m=0;m<e.length;m++){let b=e[m];if(b[1]>b[0]){let M=b[0]-f;M>0&&g(a,f,n,M,n+o),f=b[1]}}let h=i+l-f,v=10;h>0&&g(a,f,n-v/2,h,n+o+v)}return a}function Zc(e,t,i){let n=e[e.length-1];n&&n[0]==t?n[1]=i:e.push([t,i])}function Ql(e,t,i,n,l,o,a){let g=[],f=e.length;for(let h=l==1?i:n;h>=i&&h<=n;h+=l)if(t[h]===null){let m=h,b=h;if(l==1)for(;++h<=n&&t[h]===null;)b=h;else for(;--h>=i&&t[h]===null;)b=h;let M=o(e[m]),S=b==m?M:o(e[b]),T=m-l;M=a<=0&&T>=0&&T<f?o(e[T]):M;let F=b+l;S=a>=0&&F>=0&&F<f?o(e[F]):S,S>=M&&g.push([M,S])}return g}function yr(e){return e==0?Nr:e==1?De:t=>ln(t,e)}function co(e){let t=e==0?Ri:Ni,i=e==0?(l,o,a,g,f,h)=>{l.arcTo(o,a,g,f,h)}:(l,o,a,g,f,h)=>{l.arcTo(a,o,f,g,h)},n=e==0?(l,o,a,g,f)=>{l.rect(o,a,g,f)}:(l,o,a,g,f)=>{l.rect(a,o,f,g)};return(l,o,a,g,f,h=0,v=0)=>{h==0&&v==0?n(l,o,a,g,f):(h=kt(h,g/2,f/2),v=kt(v,g/2,f/2),t(l,o+h,a),i(l,o+g,a,o+g,a+f,h),i(l,o+g,a+f,o,a+f,v),i(l,o,a+f,o,a,v),i(l,o,a,o+g,a,h),l.closePath())}}const Ri=(e,t,i)=>{e.moveTo(t,i)},Ni=(e,t,i)=>{e.moveTo(i,t)},Fn=(e,t,i)=>{e.lineTo(t,i)},Un=(e,t,i)=>{e.lineTo(i,t)},Hi=co(0),Zl=co(1),uo=(e,t,i,n,l,o)=>{e.arc(t,i,n,l,o)},fo=(e,t,i,n,l,o)=>{e.arc(i,t,n,l,o)},go=(e,t,i,n,l,o,a)=>{e.bezierCurveTo(t,i,n,l,o,a)},ho=(e,t,i,n,l,o,a)=>{e.bezierCurveTo(i,t,l,n,a,o)};function po(e){return(t,i,n,l,o)=>un(t,i,(a,g,f,h,v,m,b,M,S,T,$)=>{let{pxRound:F,points:L}=a,O,E;h.ori==0?(O=Ri,E=uo):(O=Ni,E=fo);const Z=pe(L.width*ue,3);let C=(L.size-L.width)/2*ue,X=pe(C*2,3),Y=new Path2D,ne=new Path2D,{left:q,top:I,width:Q,height:R}=t.bbox;Hi(ne,q-X,I-X,Q+X*2,R+X*2);const G=V=>{if(f[V]!=null){let le=F(m(g[V],h,T,M)),U=F(b(f[V],v,$,S));O(Y,le+C,U),E(Y,le,U,C,0,Ai*2)}};if(o)o.forEach(G);else for(let V=n;V<=l;V++)G(V);return{stroke:Z>0?Y:null,fill:Y,clip:ne,flags:Nn|Dl}})}function mo(e){return(t,i,n,l,o,a)=>{n!=l&&(o!=n&&a!=n&&e(t,i,n),o!=l&&a!=l&&e(t,i,l),e(t,i,a))}}const Xc=mo(Fn),eu=mo(Un);function _o(e){const t=ae(e==null?void 0:e.alignGaps,0);return(i,n,l,o)=>un(i,n,(a,g,f,h,v,m,b,M,S,T,$)=>{[l,o]=Pi(f,l,o);let F=a.pxRound,L=R=>F(m(R,h,T,M)),O=R=>F(b(R,v,$,S)),E,Z;h.ori==0?(E=Fn,Z=Xc):(E=Un,Z=eu);const C=h.dir*(h.ori==0?1:-1),X={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Nn},Y=X.stroke;let ne=!1;if(o-l>=T*4){let R=N=>i.posToVal(N,h.key,!0),G=null,V=null,le,U,Qe,we=L(g[C==1?l:o]),se=L(g[l]),fe=L(g[o]),ee=R(C==1?se+1:fe-1);for(let N=C==1?l:o;N>=l&&N<=o;N+=C){let Ee=g[N],Se=(C==1?Ee<ee:Ee>ee)?we:L(Ee),re=f[N];Se==we?re!=null?(U=re,G==null?(E(Y,Se,O(U)),le=G=V=U):U<G?G=U:U>V&&(V=U)):re===null&&(ne=!0):(G!=null&&Z(Y,we,O(G),O(V),O(le),O(U)),re!=null?(U=re,E(Y,Se,O(U)),G=V=le=U):(G=V=null,re===null&&(ne=!0)),we=Se,ee=R(we+C))}G!=null&&G!=V&&Qe!=we&&Z(Y,we,O(G),O(V),O(le),O(U))}else for(let R=C==1?l:o;R>=l&&R<=o;R+=C){let G=f[R];G===null?ne=!0:G!=null&&E(Y,L(g[R]),O(G))}let[I,Q]=Jl(i,n);if(a.fill!=null||I!=0){let R=X.fill=new Path2D(Y),G=a.fillTo(i,n,a.min,a.max,I),V=O(G),le=L(g[l]),U=L(g[o]);C==-1&&([U,le]=[le,U]),E(R,U,V),E(R,le,V)}if(!a.spanGaps){let R=[];ne&&R.push(...Ql(g,f,l,o,C,L,t)),X.gaps=R=a.gaps(i,n,l,o,R),X.clip=Oi(R,h.ori,M,S,T,$)}return Q!=0&&(X.band=Q==2?[Rt(i,n,l,o,Y,-1),Rt(i,n,l,o,Y,1)]:Rt(i,n,l,o,Y,Q)),X})}function tu(e){const t=ae(e.align,1),i=ae(e.ascDesc,!1),n=ae(e.alignGaps,0),l=ae(e.extend,!1);return(o,a,g,f)=>un(o,a,(h,v,m,b,M,S,T,$,F,L,O)=>{[g,f]=Pi(m,g,f);let E=h.pxRound,{left:Z,width:C}=o.bbox,X=se=>E(S(se,b,L,$)),Y=se=>E(T(se,M,O,F)),ne=b.ori==0?Fn:Un;const q={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Nn},I=q.stroke,Q=b.dir*(b.ori==0?1:-1);let R=Y(m[Q==1?g:f]),G=X(v[Q==1?g:f]),V=G,le=G;l&&t==-1&&(le=Z,ne(I,le,R)),ne(I,G,R);for(let se=Q==1?g:f;se>=g&&se<=f;se+=Q){let fe=m[se];if(fe==null)continue;let ee=X(v[se]),N=Y(fe);t==1?ne(I,ee,R):ne(I,V,N),ne(I,ee,N),R=N,V=ee}let U=V;l&&t==1&&(U=Z+C,ne(I,U,R));let[Qe,we]=Jl(o,a);if(h.fill!=null||Qe!=0){let se=q.fill=new Path2D(I),fe=h.fillTo(o,a,h.min,h.max,Qe),ee=Y(fe);ne(se,U,ee),ne(se,le,ee)}if(!h.spanGaps){let se=[];se.push(...Ql(v,m,g,f,Q,X,n));let fe=h.width*ue/2,ee=i||t==1?fe:-fe,N=i||t==-1?-fe:fe;se.forEach(Ee=>{Ee[0]+=ee,Ee[1]+=N}),q.gaps=se=h.gaps(o,a,g,f,se),q.clip=Oi(se,b.ori,$,F,L,O)}return we!=0&&(q.band=we==2?[Rt(o,a,g,f,I,-1),Rt(o,a,g,f,I,1)]:Rt(o,a,g,f,I,we)),q})}function wr(e,t,i,n,l,o,a=he){if(e.length>1){let g=null;for(let f=0,h=1/0;f<e.length;f++)if(t[f]!==void 0){if(g!=null){let v=Be(e[f]-e[g]);v<h&&(h=v,a=Be(i(e[f],n,l,o)-i(e[g],n,l,o)))}g=f}}return a}function nu(e){e=e||li;const t=ae(e.size,[.6,he,1]),i=e.align||0,n=e.gap||0;let l=e.radius;l=l==null?[0,0]:typeof l=="number"?[l,0]:l;const o=ie(l),a=1-t[0],g=ae(t[1],he),f=ae(t[2],1),h=ae(e.disp,li),v=ae(e.each,M=>{}),{fill:m,stroke:b}=h;return(M,S,T,$)=>un(M,S,(F,L,O,E,Z,C,X,Y,ne,q,I)=>{let Q=F.pxRound,R=i,G=n*ue,V=g*ue,le=f*ue,U,Qe;E.ori==0?[U,Qe]=o(M,S):[Qe,U]=o(M,S);const we=E.dir*(E.ori==0?1:-1);let se=E.ori==0?Hi:Zl,fe=E.ori==0?v:(P,me,Ie,hn,Yt,At,Jt)=>{v(P,me,Ie,Yt,hn,Jt,At)},ee=ae(M.bands,jl).find(P=>P.series[0]==S),N=ee!=null?ee.dir:0,Ee=F.fillTo(M,S,F.min,F.max,N),je=Q(X(Ee,Z,I,ne)),Se,re,_t,et=q,ke=Q(F.width*ue),Lt=!1,zt=null,ct=null,Nt=null,dn=null;m!=null&&(ke==0||b!=null)&&(Lt=!0,zt=m.values(M,S,T,$),ct=new Map,new Set(zt).forEach(P=>{P!=null&&ct.set(P,new Path2D)}),ke>0&&(Nt=b.values(M,S,T,$),dn=new Map,new Set(Nt).forEach(P=>{P!=null&&dn.set(P,new Path2D)})));let{x0:fn,size:Wn}=h;if(fn!=null&&Wn!=null){R=1,L=fn.values(M,S,T,$),fn.unit==2&&(L=L.map(Ie=>M.posToVal(Y+Ie*q,E.key,!0)));let P=Wn.values(M,S,T,$);Wn.unit==2?re=P[0]*q:re=C(P[0],E,q,Y)-C(0,E,q,Y),et=wr(L,O,C,E,q,Y,et),_t=et-re+G}else et=wr(L,O,C,E,q,Y,et),_t=et*a+G,re=et-_t;_t<1&&(_t=0),ke>=re/2&&(ke=0),_t<5&&(Q=Nr);let di=_t>0,Kt=et-_t-(di?ke:0);re=Q(Tl(Kt,le,V)),Se=(R==0?re/2:R==we?0:re)-R*we*((R==0?G/2:0)+(di?ke/2:0));const Ge={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},gn=Lt?null:new Path2D;let Ct=null;if(ee!=null)Ct=M.data[ee.series[1]];else{let{y0:P,y1:me}=h;P!=null&&me!=null&&(O=me.values(M,S,T,$),Ct=P.values(M,S,T,$))}let qt=U*re,J=Qe*re;for(let P=we==1?T:$;P>=T&&P<=$;P+=we){let me=O[P];if(me==null)continue;if(Ct!=null){let Ze=Ct[P]??0;if(me-Ze==0)continue;je=X(Ze,Z,I,ne)}let Ie=E.distr!=2||h!=null?L[P]:P,hn=C(Ie,E,q,Y),Yt=X(ae(me,Ee),Z,I,ne),At=Q(hn-Se),Jt=Q(Je(Yt,je)),tt=Q(kt(Yt,je)),ut=Jt-tt;if(me!=null){let Ze=me<0?J:qt,vt=me<0?qt:J;Lt?(ke>0&&Nt[P]!=null&&se(dn.get(Nt[P]),At,tt+rt(ke/2),re,Je(0,ut-ke),Ze,vt),zt[P]!=null&&se(ct.get(zt[P]),At,tt+rt(ke/2),re,Je(0,ut-ke),Ze,vt)):se(gn,At,tt+rt(ke/2),re,Je(0,ut-ke),Ze,vt),fe(M,S,P,At-ke/2,tt,re+ke,ut)}}return ke>0?Ge.stroke=Lt?dn:gn:Lt||(Ge._fill=F.width==0?F._fill:F._stroke??F._fill,Ge.width=0),Ge.fill=Lt?ct:gn,Ge})}function iu(e,t){const i=ae(t==null?void 0:t.alignGaps,0);return(n,l,o,a)=>un(n,l,(g,f,h,v,m,b,M,S,T,$,F)=>{[o,a]=Pi(h,o,a);let L=g.pxRound,O=U=>L(b(U,v,$,S)),E=U=>L(M(U,m,F,T)),Z,C,X;v.ori==0?(Z=Ri,X=Fn,C=go):(Z=Ni,X=Un,C=ho);const Y=v.dir*(v.ori==0?1:-1);let ne=O(f[Y==1?o:a]),q=ne,I=[],Q=[];for(let U=Y==1?o:a;U>=o&&U<=a;U+=Y)if(h[U]!=null){let we=f[U],se=O(we);I.push(q=se),Q.push(E(h[U]))}const R={stroke:e(I,Q,Z,X,C,L),fill:null,clip:null,band:null,gaps:null,flags:Nn},G=R.stroke;let[V,le]=Jl(n,l);if(g.fill!=null||V!=0){let U=R.fill=new Path2D(G),Qe=g.fillTo(n,l,g.min,g.max,V),we=E(Qe);X(U,q,we),X(U,ne,we)}if(!g.spanGaps){let U=[];U.push(...Ql(f,h,o,a,Y,O,i)),R.gaps=U=g.gaps(n,l,o,a,U),R.clip=Oi(U,v.ori,S,T,$,F)}return le!=0&&(R.band=le==2?[Rt(n,l,o,a,G,-1),Rt(n,l,o,a,G,1)]:Rt(n,l,o,a,G,le)),R})}function lu(e){return iu(su,e)}function su(e,t,i,n,l,o){const a=e.length;if(a<2)return null;const g=new Path2D;if(i(g,e[0],t[0]),a==2)n(g,e[1],t[1]);else{let f=Array(a),h=Array(a-1),v=Array(a-1),m=Array(a-1);for(let b=0;b<a-1;b++)v[b]=t[b+1]-t[b],m[b]=e[b+1]-e[b],h[b]=v[b]/m[b];f[0]=h[0];for(let b=1;b<a-1;b++)h[b]===0||h[b-1]===0||h[b-1]>0!=h[b]>0?f[b]=0:(f[b]=3*(m[b-1]+m[b])/((2*m[b]+m[b-1])/h[b-1]+(m[b]+2*m[b-1])/h[b]),isFinite(f[b])||(f[b]=0));f[a-1]=h[a-2];for(let b=0;b<a-1;b++)l(g,e[b]+m[b]/3,t[b]+f[b]*m[b]/3,e[b+1]-m[b]/3,t[b+1]-f[b+1]*m[b]/3,e[b+1],t[b+1])}return g}const Bl=new Set;function Sr(){for(let e of Bl)e.syncRect(!0)}Hn&&(on(Na,zn,Sr),on(Ha,zn,Sr,!0),on(Ti,zn,()=>{Ue.pxRatio=ue}));const ru=_o(),ou=po();function xr(e,t,i,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((o,a)=>Pl(o,a,t,i))}function au(e,t){return e.map((i,n)=>n==0?{}:Te({},t,i))}function Pl(e,t,i,n){return Te({},t==0?i:n,e)}function vo(e,t,i){return t==null?On:[t,i]}const cu=vo;function uu(e,t,i){return t==null?On:Ei(t,i,Vl,!0)}function bo(e,t,i,n){return t==null?On:zi(t,i,e.scales[n].log,!1)}const du=bo;function yo(e,t,i,n){return t==null?On:Ul(t,i,e.scales[n].log,!1)}const fu=yo;function gu(e,t,i,n,l){let o=Je(tr(e),tr(t)),a=t-e,g=xt(l/n*a,i);do{let f=i[g],h=n*f/a;if(h>=l&&o+(f<5?Gt.get(f):0)<=17)return[f,h]}while(++g<i.length);return[0,0]}function kr(e){let t,i;return e=e.replace(/(\d+)px/,(n,l)=>(t=De((i=+l)*ue))+"px"),[e,t,i]}function hu(e){e.show&&[e.font,e.labelFont].forEach(t=>{let i=pe(t[2]*ue,1);t[0]=t[0].replace(/[0-9.]+px/,i+"px"),t[1]=i})}function Ue(e,t,i){const n={mode:ae(e.mode,1)},l=n.mode;function o(s,r,u,d){let p=r.valToPct(s);return d+u*(r.dir==-1?1-p:p)}function a(s,r,u,d){let p=r.valToPct(s);return d+u*(r.dir==-1?p:1-p)}function g(s,r,u,d){return r.ori==0?o(s,r,u,d):a(s,r,u,d)}n.valToPosH=o,n.valToPosV=a;let f=!1;n.status=0;const h=n.root=pt(wa);if(e.id!=null&&(h.id=e.id),st(h,e.class),e.title){let s=pt(ka,h);s.textContent=e.title}const v=St("canvas"),m=n.ctx=v.getContext("2d"),b=pt(Ma,h);on("click",b,s=>{s.target===S&&(_e!=Mn||xe!=Ln)&&Fe.click(n,s)},!0);const M=n.under=pt(La,b);b.appendChild(v);const S=n.over=pt(Aa,b);e=Rn(e);const T=+ae(e.pxAlign,1),$=yr(T);(e.plugins||[]).forEach(s=>{s.opts&&(e=s.opts(n,e)||e)});const F=e.ms||.001,L=n.series=l==1?xr(e.series||[],gr,vr,!1):au(e.series||[null],_r),O=n.axes=xr(e.axes||[],fr,pr,!0),E=n.scales={},Z=n.bands=e.bands||[];Z.forEach(s=>{s.fill=ie(s.fill||null),s.dir=ae(s.dir,-1)});const C=l==2?L[1].facets[0].scale:L[0].scale,X={axes:sa,series:ea},Y=(e.drawOrder||["axes","series"]).map(s=>X[s]);function ne(s){const r=s.distr==3?u=>Ot(u>0?u:s.clamp(n,u,s.min,s.max,s.key)):s.distr==4?u=>_l(u,s.asinh):s.distr==100?u=>s.fwd(u):u=>u;return u=>{let d=r(u),{_min:p,_max:_}=s,w=_-p;return(d-p)/w}}function q(s){let r=E[s];if(r==null){let u=(e.scales||li)[s]||li;if(u.from!=null){q(u.from);let d=Te({},E[u.from],u,{key:s});d.valToPct=ne(d),E[s]=d}else{r=E[s]=Te({},s==C?oo:Jc,u),r.key=s;let d=r.time,p=r.range,_=jt(p);if((s!=C||l==2&&!d)&&(_&&(p[0]==null||p[1]==null)&&(p={min:p[0]==null?Zs:{mode:1,hard:p[0],soft:p[0]},max:p[1]==null?Zs:{mode:1,hard:p[1],soft:p[1]}},_=!1),!_&&$i(p))){let w=p;p=(x,A,D)=>A==null?On:Ei(A,D,w)}r.range=ie(p||(d?cu:s==C?r.distr==3?du:r.distr==4?fu:vo:r.distr==3?bo:r.distr==4?yo:uu)),r.auto=ie(_?!1:r.auto),r.clamp=ie(r.clamp||Yc),r._min=r._max=null,r.valToPct=ne(r)}}}q("x"),q("y"),l==1&&L.forEach(s=>{q(s.scale)}),O.forEach(s=>{q(s.scale)});for(let s in e.scales)q(s);const I=E[C],Q=I.distr;let R,G;I.ori==0?(st(h,Sa),R=o,G=a):(st(h,xa),R=a,G=o);const V={};for(let s in E){let r=E[s];(r.min!=null||r.max!=null)&&(V[s]={min:r.min,max:r.max},r.min=r.max=null)}const le=e.tzDate||(s=>new Date(De(s/F))),U=e.fmtDate||Gl,Qe=F==1?Sc(le):Mc(le),we=cr(le,ar(F==1?wc:kc,U)),se=dr(le,ur(Ac,U)),fe=[],ee=n.legend=Te({},Ic,e.legend),N=n.cursor=Te({},$c,{drag:{y:l==2}},e.cursor),Ee=ee.show,je=N.show,Se=ee.markers;ee.idxs=fe,Se.width=ie(Se.width),Se.dash=ie(Se.dash),Se.stroke=ie(Se.stroke),Se.fill=ie(Se.fill);let re,_t,et,ke=[],Lt=[],zt,ct=!1,Nt={};if(ee.live){const s=L[1]?L[1].values:null;ct=s!=null,zt=ct?s(n,1,0):{_:0};for(let r in zt)Nt[r]=Hl}if(Ee)if(re=St("table",Pa,h),et=St("tbody",null,re),ee.mount(n,re),ct){_t=St("thead",null,re,et);let s=St("tr",null,_t);St("th",null,s);for(var dn in zt)St("th",Ns,s).textContent=dn}else st(re,Ca),ee.live&&st(re,za);const fn={show:!0},Wn={show:!1};function di(s,r){if(r==0&&(ct||!ee.live||l==2))return On;let u=[],d=St("tr",$a,et,et.childNodes[r]);st(d,s.class),s.show||st(d,rn);let p=St("th",null,d);if(Se.show){let x=pt(Oa,p);if(r>0){let A=Se.width(n,r);A&&(x.style.border=A+"px "+Se.dash(n,r)+" "+Se.stroke(n,r)),x.style.background=Se.fill(n,r)}}let _=pt(Ns,p);s.label instanceof HTMLElement?_.appendChild(s.label):_.textContent=s.label,r>0&&(Se.show||(_.style.color=s.width>0?Se.stroke(n,r):Se.fill(n,r)),Ge("click",p,x=>{if(N._lock)return;Zt(x);let A=L.indexOf(s);if((x.ctrlKey||x.metaKey)!=ee.isolate){let D=L.some((B,z)=>z>0&&z!=A&&B.show);L.forEach((B,z)=>{z>0&&Et(z,D?z==A?fn:Wn:fn,!0,Ae.setSeries)})}else Et(A,{show:!s.show},!0,Ae.setSeries)},!1),mn&&Ge(Vs,p,x=>{N._lock||(Zt(x),Et(L.indexOf(s),Tn,!0,Ae.setSeries))},!1));for(var w in zt){let x=St("td",Ra,d);x.textContent="--",u.push(x)}return[d,u]}const Kt=new Map;function Ge(s,r,u,d=!0){const p=Kt.get(r)||{},_=N.bind[s](n,r,u,d);_&&(on(s,r,p[s]=_),Kt.set(r,p))}function gn(s,r,u){const d=Kt.get(r)||{};for(let p in d)(s==null||p==s)&&(Al(p,r,d[p]),delete d[p]);s==null&&Kt.delete(r)}let Ct=0,qt=0,J=0,P=0,me=0,Ie=0,hn=me,Yt=Ie,At=J,Jt=P,tt=0,ut=0,Ze=0,vt=0;n.bbox={};let ji=!1,fi=!1,pn=!1,Qt=!1,gi=!1,dt=!1;function Gi(s,r,u){(u||s!=n.width||r!=n.height)&&cs(s,r),wn(!1),pn=!0,fi=!0,Sn()}function cs(s,r){n.width=Ct=J=s,n.height=qt=P=r,me=Ie=0,Ko(),qo();let u=n.bbox;tt=u.left=ln(me*ue,.5),ut=u.top=ln(Ie*ue,.5),Ze=u.width=ln(J*ue,.5),vt=u.height=ln(P*ue,.5)}const Wo=3;function jo(){let s=!1,r=0;for(;!s;){r++;let u=ia(r),d=la(r);s=r==Wo||u&&d,s||(cs(n.width,n.height),fi=!0)}}function Go({width:s,height:r}){Gi(s,r)}n.setSize=Go;function Ko(){let s=!1,r=!1,u=!1,d=!1;O.forEach((p,_)=>{if(p.show&&p._show){let{side:w,_size:x}=p,A=w%2,D=p.label!=null?p.labelSize:0,B=x+D;B>0&&(A?(J-=B,w==3?(me+=B,d=!0):u=!0):(P-=B,w==0?(Ie+=B,s=!0):r=!0))}}),Xt[0]=s,Xt[1]=u,Xt[2]=r,Xt[3]=d,J-=Ht[1]+Ht[3],me+=Ht[3],P-=Ht[2]+Ht[0],Ie+=Ht[0]}function qo(){let s=me+J,r=Ie+P,u=me,d=Ie;function p(_,w){switch(_){case 1:return s+=w,s-w;case 2:return r+=w,r-w;case 3:return u-=w,u+w;case 0:return d-=w,d+w}}O.forEach((_,w)=>{if(_.show&&_._show){let x=_.side;_._pos=p(x,_._size),_.label!=null&&(_._lpos=p(x,_.labelSize))}})}if(N.dataIdx==null){let s=N.hover,r=s.skip=new Set(s.skip??[]);r.add(void 0);let u=s.prox=ie(s.prox),d=s.bias??(s.bias=0);N.dataIdx=(p,_,w,x)=>{if(_==0)return w;let A=w,D=u(p,_,w,x)??he,B=D>=0&&D<he,z=I.ori==0?J:P,K=N.left,ce=t[0],oe=t[_];if(r.has(oe[w])){A=null;let te=null,W=null,H;if(d==0||d==-1)for(H=w;te==null&&H-- >0;)r.has(oe[H])||(te=H);if(d==0||d==1)for(H=w;W==null&&H++<oe.length;)r.has(oe[H])||(W=H);if(te!=null||W!=null)if(B){let be=te==null?-1/0:R(ce[te],I,z,0),Me=W==null?1/0:R(ce[W],I,z,0),Ne=K-be,ge=Me-K;Ne<=ge?Ne<=D&&(A=te):ge<=D&&(A=W)}else A=W==null?te:te==null?W:w-te<=W-w?te:W}else B&&Be(K-R(ce[w],I,z,0))>D&&(A=null);return A}}const Zt=s=>{N.event=s};N.idxs=fe,N._lock=!1;let Ve=N.points;Ve.show=ie(Ve.show),Ve.size=ie(Ve.size),Ve.stroke=ie(Ve.stroke),Ve.width=ie(Ve.width),Ve.fill=ie(Ve.fill);const Tt=n.focus=Te({},e.focus||{alpha:.3},N.focus),mn=Tt.prox>=0,_n=mn&&Ve.one;let ft=[],vn=[],bn=[];function us(s,r){let u=Ve.show(n,r);if(u instanceof HTMLElement)return st(u,Ba),st(u,s.class),Pt(u,-10,-10,J,P),S.insertBefore(u,ft[r]),u}function ds(s,r){if(l==1||r>0){let u=l==1&&E[s.scale].time,d=s.value;s.value=u?lr(d)?dr(le,ur(d,U)):d||se:d||Gc,s.label=s.label||(u?Rc:Oc)}if(_n||r>0){s.width=s.width==null?1:s.width,s.paths=s.paths||ru||Ja,s.fillTo=ie(s.fillTo||Qc),s.pxAlign=+ae(s.pxAlign,T),s.pxRound=yr(s.pxAlign),s.stroke=ie(s.stroke||null),s.fill=ie(s.fill||null),s._stroke=s._fill=s._paths=s._focus=null;let u=Kc(Je(1,s.width),1),d=s.points=Te({},{size:u,width:Je(1,u*.2),stroke:s.stroke,space:u*2,paths:ou,_stroke:null,_fill:null},s.points);d.show=ie(d.show),d.filter=ie(d.filter),d.fill=ie(d.fill),d.stroke=ie(d.stroke),d.paths=ie(d.paths),d.pxAlign=s.pxAlign}if(Ee){let u=di(s,r);ke.splice(r,0,u[0]),Lt.splice(r,0,u[1]),ee.values.push(null)}if(je){fe.splice(r,0,null);let u=null;_n?r==0&&(u=us(s,r)):r>0&&(u=us(s,r)),ft.splice(r,0,u),vn.splice(r,0,0),bn.splice(r,0,0)}Re("addSeries",r)}function Yo(s,r){r=r??L.length,s=l==1?Pl(s,r,gr,vr):Pl(s,r,{},_r),L.splice(r,0,s),ds(L[r],r)}n.addSeries=Yo;function Jo(s){if(L.splice(s,1),Ee){ee.values.splice(s,1),Lt.splice(s,1);let r=ke.splice(s,1)[0];gn(null,r.firstChild),r.remove()}je&&(fe.splice(s,1),ft.splice(s,1)[0].remove(),vn.splice(s,1),bn.splice(s,1)),Re("delSeries",s)}n.delSeries=Jo;const Xt=[!1,!1,!1,!1];function Qo(s,r){if(s._show=s.show,s.show){let u=s.side%2,d=E[s.scale];d==null&&(s.scale=u?L[1].scale:C,d=E[s.scale]);let p=d.time;s.size=ie(s.size),s.space=ie(s.space),s.rotate=ie(s.rotate),jt(s.incrs)&&s.incrs.forEach(w=>{!Gt.has(w)&&Gt.set(w,Ur(w))}),s.incrs=ie(s.incrs||(d.distr==2?vc:p?F==1?yc:xc:sn)),s.splits=ie(s.splits||(p&&d.distr==1?Qe:d.distr==3?El:d.distr==4?Fc:Hc)),s.stroke=ie(s.stroke),s.grid.stroke=ie(s.grid.stroke),s.ticks.stroke=ie(s.ticks.stroke),s.border.stroke=ie(s.border.stroke);let _=s.values;s.values=jt(_)&&!jt(_[0])?ie(_):p?jt(_)?cr(le,ar(_,U)):lr(_)?Lc(le,_):_||we:_||Nc,s.filter=ie(s.filter||(d.distr>=3&&d.log==10?Wc:d.distr==3&&d.log==2?jc:Hr)),s.font=kr(s.font),s.labelFont=kr(s.labelFont),s._size=s.size(n,null,r,0),s._space=s._rotate=s._incrs=s._found=s._splits=s._values=null,s._size>0&&(Xt[r]=!0,s._el=pt(Ta,b))}}function jn(s,r,u,d){let[p,_,w,x]=u,A=r%2,D=0;return A==0&&(x||_)&&(D=r==0&&!p||r==2&&!w?De(fr.size/3):0),A==1&&(p||w)&&(D=r==1&&!_||r==3&&!x?De(pr.size/2):0),D}const fs=n.padding=(e.padding||[jn,jn,jn,jn]).map(s=>ie(ae(s,jn))),Ht=n._padding=fs.map((s,r)=>s(n,r,Xt,0));let He,ze=null,Ce=null;const hi=l==1?L[0].idxs:null;let bt=null,Gn=!1;function gs(s,r){if(t=s??[],n.data=n._data=t,l==2){He=0;for(let u=1;u<L.length;u++)He+=t[u][0].length}else{t.length==0&&(n.data=n._data=t=[[]]),bt=t[0],He=bt.length;let u=t;if(Q==2){u=t.slice();let d=u[0]=Array(He);for(let p=0;p<He;p++)d[p]=p}n._data=t=u}if(wn(!0),Re("setData"),Q==2&&(pn=!0),r!==!1){let u=I;u.auto(n,Gn)?Ki():Ut(C,u.min,u.max),Qt=Qt||N.left>=0,dt=!0,Sn()}}n.setData=gs;function Ki(){Gn=!0;let s,r;l==1&&(He>0?(ze=hi[0]=0,Ce=hi[1]=He-1,s=t[0][ze],r=t[0][Ce],Q==2?(s=ze,r=Ce):s==r&&(Q==3?[s,r]=zi(s,s,I.log,!1):Q==4?[s,r]=Ul(s,s,I.log,!1):I.time?r=s+De(86400/F):[s,r]=Ei(s,r,Vl,!0))):(ze=hi[0]=s=null,Ce=hi[1]=r=null)),Ut(C,s,r)}let pi,yn,qi,Yi,Ji,Qi,Zi,Xi,el,Xe;function hs(s,r,u,d,p,_){s??(s=Fs),u??(u=jl),d??(d="butt"),p??(p=Fs),_??(_="round"),s!=pi&&(m.strokeStyle=pi=s),p!=yn&&(m.fillStyle=yn=p),r!=qi&&(m.lineWidth=qi=r),_!=Ji&&(m.lineJoin=Ji=_),d!=Qi&&(m.lineCap=Qi=d),u!=Yi&&m.setLineDash(Yi=u)}function ps(s,r,u,d){r!=yn&&(m.fillStyle=yn=r),s!=Zi&&(m.font=Zi=s),u!=Xi&&(m.textAlign=Xi=u),d!=el&&(m.textBaseline=el=d)}function tl(s,r,u,d,p=0){if(d.length>0&&s.auto(n,Gn)&&(r==null||r.min==null)){let _=ae(ze,0),w=ae(Ce,d.length-1),x=u.min==null?Wa(d,_,w,p,s.distr==3):[u.min,u.max];s.min=kt(s.min,u.min=x[0]),s.max=Je(s.max,u.max=x[1])}}const ms={min:null,max:null};function Zo(){for(let d in E){let p=E[d];V[d]==null&&(p.min==null||V[C]!=null&&p.auto(n,Gn))&&(V[d]=ms)}for(let d in E){let p=E[d];V[d]==null&&p.from!=null&&V[p.from]!=null&&(V[d]=ms)}V[C]!=null&&wn(!0);let s={};for(let d in V){let p=V[d];if(p!=null){let _=s[d]=Rn(E[d],Xa);if(p.min!=null)Te(_,p);else if(d!=C||l==2)if(He==0&&_.from==null){let w=_.range(n,null,null,d);_.min=w[0],_.max=w[1]}else _.min=he,_.max=-he}}if(He>0){L.forEach((d,p)=>{if(l==1){let _=d.scale,w=V[_];if(w==null)return;let x=s[_];if(p==0){let A=x.range(n,x.min,x.max,_);x.min=A[0],x.max=A[1],ze=xt(x.min,t[0]),Ce=xt(x.max,t[0]),Ce-ze>1&&(t[0][ze]<x.min&&ze++,t[0][Ce]>x.max&&Ce--),d.min=bt[ze],d.max=bt[Ce]}else d.show&&d.auto&&tl(x,w,d,t[p],d.sorted);d.idxs[0]=ze,d.idxs[1]=Ce}else if(p>0&&d.show&&d.auto){let[_,w]=d.facets,x=_.scale,A=w.scale,[D,B]=t[p],z=s[x],K=s[A];z!=null&&tl(z,V[x],_,D,_.sorted),K!=null&&tl(K,V[A],w,B,w.sorted),d.min=w.min,d.max=w.max}});for(let d in s){let p=s[d],_=V[d];if(p.from==null&&(_==null||_.min==null)){let w=p.range(n,p.min==he?null:p.min,p.max==-he?null:p.max,d);p.min=w[0],p.max=w[1]}}}for(let d in s){let p=s[d];if(p.from!=null){let _=s[p.from];if(_.min==null)p.min=p.max=null;else{let w=p.range(n,_.min,_.max,d);p.min=w[0],p.max=w[1]}}}let r={},u=!1;for(let d in s){let p=s[d],_=E[d];if(_.min!=p.min||_.max!=p.max){_.min=p.min,_.max=p.max;let w=_.distr;_._min=w==3?Ot(_.min):w==4?_l(_.min,_.asinh):w==100?_.fwd(_.min):_.min,_._max=w==3?Ot(_.max):w==4?_l(_.max,_.asinh):w==100?_.fwd(_.max):_.max,r[d]=u=!0}}if(u){L.forEach((d,p)=>{l==2?p>0&&r.y&&(d._paths=null):r[d.scale]&&(d._paths=null)});for(let d in r)pn=!0,Re("setScale",d);je&&N.left>=0&&(Qt=dt=!0)}for(let d in V)V[d]=null}function Xo(s){let r=Tl(ze-1,0,He-1),u=Tl(Ce+1,0,He-1);for(;s[r]==null&&r>0;)r--;for(;s[u]==null&&u<He-1;)u++;return[r,u]}function ea(){if(He>0){let s=L.some(r=>r._focus)&&Xe!=Tt.alpha;s&&(m.globalAlpha=Xe=Tt.alpha),L.forEach((r,u)=>{if(u>0&&r.show&&(_s(u,!1),_s(u,!0),r._paths==null)){let d=Xe;Xe!=r.alpha&&(m.globalAlpha=Xe=r.alpha);let p=l==2?[0,t[u][0].length-1]:Xo(t[u]);r._paths=r.paths(n,u,p[0],p[1]),Xe!=d&&(m.globalAlpha=Xe=d)}}),L.forEach((r,u)=>{if(u>0&&r.show){let d=Xe;Xe!=r.alpha&&(m.globalAlpha=Xe=r.alpha),r._paths!=null&&vs(u,!1);{let p=r._paths!=null?r._paths.gaps:null,_=r.points.show(n,u,ze,Ce,p),w=r.points.filter(n,u,_,p);(_||w)&&(r.points._paths=r.points.paths(n,u,ze,Ce,w),vs(u,!0))}Xe!=d&&(m.globalAlpha=Xe=d),Re("drawSeries",u)}}),s&&(m.globalAlpha=Xe=1)}}function _s(s,r){let u=r?L[s].points:L[s];u._stroke=u.stroke(n,s),u._fill=u.fill(n,s)}function vs(s,r){let u=r?L[s].points:L[s],{stroke:d,fill:p,clip:_,flags:w,_stroke:x=u._stroke,_fill:A=u._fill,_width:D=u.width}=u._paths;D=pe(D*ue,3);let B=null,z=D%2/2;r&&A==null&&(A=D>0?"#fff":x);let K=u.pxAlign==1&&z>0;if(K&&m.translate(z,z),!r){let ce=tt-D/2,oe=ut-D/2,te=Ze+D,W=vt+D;B=new Path2D,B.rect(ce,oe,te,W)}r?nl(x,D,u.dash,u.cap,A,d,p,w,_):ta(s,x,D,u.dash,u.cap,A,d,p,w,B,_),K&&m.translate(-z,-z)}function ta(s,r,u,d,p,_,w,x,A,D,B){let z=!1;A!=0&&Z.forEach((K,ce)=>{if(K.series[0]==s){let oe=L[K.series[1]],te=t[K.series[1]],W=(oe._paths||li).band;jt(W)&&(W=K.dir==1?W[0]:W[1]);let H,be=null;oe.show&&W&&Ga(te,ze,Ce)?(be=K.fill(n,ce)||_,H=oe._paths.clip):W=null,nl(r,u,d,p,be,w,x,A,D,B,H,W),z=!0}}),z||nl(r,u,d,p,_,w,x,A,D,B)}const bs=Nn|Dl;function nl(s,r,u,d,p,_,w,x,A,D,B,z){hs(s,r,u,d,p),(A||D||z)&&(m.save(),A&&m.clip(A),D&&m.clip(D)),z?(x&bs)==bs?(m.clip(z),B&&m.clip(B),_i(p,w),mi(s,_,r)):x&Dl?(_i(p,w),m.clip(z),mi(s,_,r)):x&Nn&&(m.save(),m.clip(z),B&&m.clip(B),_i(p,w),m.restore(),mi(s,_,r)):(_i(p,w),mi(s,_,r)),(A||D||z)&&m.restore()}function mi(s,r,u){u>0&&(r instanceof Map?r.forEach((d,p)=>{m.strokeStyle=pi=p,m.stroke(d)}):r!=null&&s&&m.stroke(r))}function _i(s,r){r instanceof Map?r.forEach((u,d)=>{m.fillStyle=yn=d,m.fill(u)}):r!=null&&s&&m.fill(r)}function na(s,r,u,d){let p=O[s],_;if(d<=0)_=[0,0];else{let w=p._space=p.space(n,s,r,u,d),x=p._incrs=p.incrs(n,s,r,u,d,w);_=gu(r,u,x,d,w)}return p._found=_}function il(s,r,u,d,p,_,w,x,A,D){let B=w%2/2;T==1&&m.translate(B,B),hs(x,w,A,D,x),m.beginPath();let z,K,ce,oe,te=p+(d==0||d==3?-_:_);u==0?(K=p,oe=te):(z=p,ce=te);for(let W=0;W<s.length;W++)r[W]!=null&&(u==0?z=ce=s[W]:K=oe=s[W],m.moveTo(z,K),m.lineTo(ce,oe));m.stroke(),T==1&&m.translate(-B,-B)}function ia(s){let r=!0;return O.forEach((u,d)=>{if(!u.show)return;let p=E[u.scale];if(p.min==null){u._show&&(r=!1,u._show=!1,wn(!1));return}else u._show||(r=!1,u._show=!0,wn(!1));let _=u.side,w=_%2,{min:x,max:A}=p,[D,B]=na(d,x,A,w==0?J:P);if(B==0)return;let z=p.distr==2,K=u._splits=u.splits(n,d,x,A,D,B,z),ce=p.distr==2?K.map(H=>bt[H]):K,oe=p.distr==2?bt[K[1]]-bt[K[0]]:D,te=u._values=u.values(n,u.filter(n,ce,d,B,oe),d,B,oe);u._rotate=_==2?u.rotate(n,te,d,B):0;let W=u._size;u._size=mt(u.size(n,te,d,s)),W!=null&&u._size!=W&&(r=!1)}),r}function la(s){let r=!0;return fs.forEach((u,d)=>{let p=u(n,d,Xt,s);p!=Ht[d]&&(r=!1),Ht[d]=p}),r}function sa(){for(let s=0;s<O.length;s++){let r=O[s];if(!r.show||!r._show)continue;let u=r.side,d=u%2,p,_,w=r.stroke(n,s),x=u==0||u==3?-1:1,[A,D]=r._found;if(r.label!=null){let qe=r.labelGap*x,lt=De((r._lpos+qe)*ue);ps(r.labelFont[0],w,"center",u==2?Zn:Hs),m.save(),d==1?(p=_=0,m.translate(lt,De(ut+vt/2)),m.rotate((u==3?-Ai:Ai)/2)):(p=De(tt+Ze/2),_=lt);let nn=Rr(r.label)?r.label(n,s,A,D):r.label;m.fillText(nn,p,_),m.restore()}if(D==0)continue;let B=E[r.scale],z=d==0?Ze:vt,K=d==0?tt:ut,ce=r._splits,oe=B.distr==2?ce.map(qe=>bt[qe]):ce,te=B.distr==2?bt[ce[1]]-bt[ce[0]]:A,W=r.ticks,H=r.border,be=W.show?W.size:0,Me=De(be*ue),Ne=De((r.alignTo==2?r._size-be-r.gap:r.gap)*ue),ge=r._rotate*-Ai/180,Le=$(r._pos*ue),nt=(Me+Ne)*x,Ke=Le+nt;_=d==0?Ke:0,p=d==1?Ke:0;let gt=r.font[0],yt=r.align==1?In:r.align==2?hl:ge>0?In:ge<0?hl:d==0?"center":u==3?hl:In,Dt=ge||d==1?"middle":u==2?Zn:Hs;ps(gt,w,yt,Dt);let it=r.font[1]*r.lineGap,ht=ce.map(qe=>$(g(qe,B,z,K))),wt=r._values;for(let qe=0;qe<wt.length;qe++){let lt=wt[qe];if(lt!=null){d==0?p=ht[qe]:_=ht[qe],lt=""+lt;let nn=lt.indexOf(`
`)==-1?[lt]:lt.split(/\n/gm);for(let Ye=0;Ye<nn.length;Ye++){let Rs=nn[Ye];ge?(m.save(),m.translate(p,_+Ye*it),m.rotate(ge),m.fillText(Rs,0,0),m.restore()):m.fillText(Rs,p,_+Ye*it)}}}W.show&&il(ht,W.filter(n,oe,s,D,te),d,u,Le,Me,pe(W.width*ue,3),W.stroke(n,s),W.dash,W.cap);let Bt=r.grid;Bt.show&&il(ht,Bt.filter(n,oe,s,D,te),d,d==0?2:1,d==0?ut:tt,d==0?vt:Ze,pe(Bt.width*ue,3),Bt.stroke(n,s),Bt.dash,Bt.cap),H.show&&il([Le],[1],d==0?1:0,d==0?1:2,d==1?ut:tt,d==1?vt:Ze,pe(H.width*ue,3),H.stroke(n,s),H.dash,H.cap)}Re("drawAxes")}function wn(s){L.forEach((r,u)=>{u>0&&(r._paths=null,s&&(l==1?(r.min=null,r.max=null):r.facets.forEach(d=>{d.min=null,d.max=null})))})}let vi=!1,ll=!1,Kn=[];function ra(){ll=!1;for(let s=0;s<Kn.length;s++)Re(...Kn[s]);Kn.length=0}function Sn(){vi||(rc(ys),vi=!0)}function oa(s,r=!1){vi=!0,ll=r,s(n),ys(),r&&Kn.length>0&&queueMicrotask(ra)}n.batch=oa;function ys(){if(ji&&(Zo(),ji=!1),pn&&(jo(),pn=!1),fi){if(ye(M,In,me),ye(M,Zn,Ie),ye(M,ei,J),ye(M,ti,P),ye(S,In,me),ye(S,Zn,Ie),ye(S,ei,J),ye(S,ti,P),ye(b,ei,Ct),ye(b,ti,qt),v.width=De(Ct*ue),v.height=De(qt*ue),O.forEach(({_el:s,_show:r,_size:u,_pos:d,side:p})=>{if(s!=null)if(r){let _=p===3||p===0?u:0,w=p%2==1;ye(s,w?"left":"top",d-_),ye(s,w?"width":"height",u),ye(s,w?"top":"left",w?Ie:me),ye(s,w?"height":"width",w?P:J),Ll(s,rn)}else st(s,rn)}),pi=yn=qi=Ji=Qi=Zi=Xi=el=Yi=null,Xe=1,Jn(!0),me!=hn||Ie!=Yt||J!=At||P!=Jt){wn(!1);let s=J/At,r=P/Jt;if(je&&!Qt&&N.left>=0){N.left*=s,N.top*=r,xn&&Pt(xn,De(N.left),0,J,P),kn&&Pt(kn,0,De(N.top),J,P);for(let u=0;u<ft.length;u++){let d=ft[u];d!=null&&(vn[u]*=s,bn[u]*=r,Pt(d,mt(vn[u]),mt(bn[u]),J,P))}}if(ve.show&&!gi&&ve.left>=0&&ve.width>0){ve.left*=s,ve.width*=s,ve.top*=r,ve.height*=r;for(let u in ul)ye(An,u,ve[u])}hn=me,Yt=Ie,At=J,Jt=P}Re("setSize"),fi=!1}Ct>0&&qt>0&&(m.clearRect(0,0,v.width,v.height),Re("drawClear"),Y.forEach(s=>s()),Re("draw")),ve.show&&gi&&(bi(ve),gi=!1),je&&Qt&&(tn(null,!0,!1),Qt=!1),ee.show&&ee.live&&dt&&(al(),dt=!1),f||(f=!0,n.status=1,Re("ready")),Gn=!1,vi=!1}n.redraw=(s,r)=>{pn=r||!1,s!==!1?Ut(C,I.min,I.max):Sn()};function sl(s,r){let u=E[s];if(u.from==null){if(He==0){let d=u.range(n,r.min,r.max,s);r.min=d[0],r.max=d[1]}if(r.min>r.max){let d=r.min;r.min=r.max,r.max=d}if(He>1&&r.min!=null&&r.max!=null&&r.max-r.min<1e-16)return;s==C&&u.distr==2&&He>0&&(r.min=xt(r.min,t[0]),r.max=xt(r.max,t[0]),r.min==r.max&&r.max++),V[s]=r,ji=!0,Sn()}}n.setScale=sl;let rl,ol,xn,kn,ws,Ss,Mn,Ln,xs,ks,_e,xe,Ft=!1;const Fe=N.drag;let $e=Fe.x,Oe=Fe.y;je&&(N.x&&(rl=pt(Ia,S)),N.y&&(ol=pt(Da,S)),I.ori==0?(xn=rl,kn=ol):(xn=ol,kn=rl),_e=N.left,xe=N.top);const ve=n.select=Te({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),An=ve.show?pt(Ea,ve.over?S:M):null;function bi(s,r){if(ve.show){for(let u in s)ve[u]=s[u],u in ul&&ye(An,u,s[u]);r!==!1&&Re("setSelect")}}n.setSelect=bi;function aa(s){if(L[s].show)Ee&&Ll(ke[s],rn);else if(Ee&&st(ke[s],rn),je){let u=_n?ft[0]:ft[s];u!=null&&Pt(u,-10,-10,J,P)}}function Ut(s,r,u){sl(s,{min:r,max:u})}function Et(s,r,u,d){r.focus!=null&&ga(s),r.show!=null&&L.forEach((p,_)=>{_>0&&(s==_||s==null)&&(p.show=r.show,aa(_),l==2?(Ut(p.facets[0].scale,null,null),Ut(p.facets[1].scale,null,null)):Ut(p.scale,null,null),Sn())}),u!==!1&&Re("setSeries",s,r),d&&Qn("setSeries",n,s,r)}n.setSeries=Et;function ca(s,r){Te(Z[s],r)}function ua(s,r){s.fill=ie(s.fill||null),s.dir=ae(s.dir,-1),r=r??Z.length,Z.splice(r,0,s)}function da(s){s==null?Z.length=0:Z.splice(s,1)}n.addBand=ua,n.setBand=ca,n.delBand=da;function fa(s,r){L[s].alpha=r,je&&ft[s]!=null&&(ft[s].style.opacity=r),Ee&&ke[s]&&(ke[s].style.opacity=r)}let $t,Vt,en;const Tn={focus:!0};function ga(s){if(s!=en){let r=s==null,u=Tt.alpha!=1;L.forEach((d,p)=>{if(l==1||p>0){let _=r||p==0||p==s;d._focus=r?null:_,u&&fa(p,_?1:Tt.alpha)}}),en=s,u&&Sn()}}Ee&&mn&&Ge(Ws,re,s=>{N._lock||(Zt(s),en!=null&&Et(null,Tn,!0,Ae.setSeries))});function It(s,r,u){let d=E[r];u&&(s=s/ue-(d.ori==1?Ie:me));let p=J;d.ori==1&&(p=P,s=p-s),d.dir==-1&&(s=p-s);let _=d._min,w=d._max,x=s/p,A=_+(w-_)*x,D=d.distr;return D==3?$n(10,A):D==4?qa(A,d.asinh):D==100?d.bwd(A):A}function ha(s,r){let u=It(s,C,r);return xt(u,t[0],ze,Ce)}n.valToIdx=s=>xt(s,t[0]),n.posToIdx=ha,n.posToVal=It,n.valToPos=(s,r,u)=>E[r].ori==0?o(s,E[r],u?Ze:J,u?tt:0):a(s,E[r],u?vt:P,u?ut:0),n.setCursor=(s,r,u)=>{_e=s.left,xe=s.top,tn(null,r,u)};function Ms(s,r){ye(An,In,ve.left=s),ye(An,ei,ve.width=r)}function Ls(s,r){ye(An,Zn,ve.top=s),ye(An,ti,ve.height=r)}let qn=I.ori==0?Ms:Ls,Yn=I.ori==1?Ms:Ls;function pa(){if(Ee&&ee.live)for(let s=l==2?1:0;s<L.length;s++){if(s==0&&ct)continue;let r=ee.values[s],u=0;for(let d in r)Lt[s][u++].firstChild.nodeValue=r[d]}}function al(s,r){if(s!=null&&(s.idxs?s.idxs.forEach((u,d)=>{fe[d]=u}):Za(s.idx)||fe.fill(s.idx),ee.idx=fe[0]),Ee&&ee.live){for(let u=0;u<L.length;u++)(u>0||l==1&&!ct)&&ma(u,fe[u]);pa()}dt=!1,r!==!1&&Re("setLegend")}n.setLegend=al;function ma(s,r){let u=L[s],d=s==0&&Q==2?bt:t[s],p;ct?p=u.values(n,s,r)??Nt:(p=u.value(n,r==null?null:d[r],s,r),p=p==null?Nt:{_:p}),ee.values[s]=p}function tn(s,r,u){xs=_e,ks=xe,[_e,xe]=N.move(n,_e,xe),N.left=_e,N.top=xe,je&&(xn&&Pt(xn,De(_e),0,J,P),kn&&Pt(kn,0,De(xe),J,P));let d,p=ze>Ce;$t=he,Vt=null;let _=I.ori==0?J:P,w=I.ori==1?J:P;if(_e<0||He==0||p){d=N.idx=null;for(let x=0;x<L.length;x++){let A=ft[x];A!=null&&Pt(A,-10,-10,J,P)}mn&&Et(null,Tn,!0,s==null&&Ae.setSeries),ee.live&&(fe.fill(d),dt=!0)}else{let x,A,D;l==1&&(x=I.ori==0?_e:xe,A=It(x,C),d=N.idx=xt(A,t[0],ze,Ce),D=R(t[0][d],I,_,0));let B=-10,z=-10,K=0,ce=0,oe=!0,te="",W="";for(let H=l==2?1:0;H<L.length;H++){let be=L[H],Me=fe[H],Ne=Me==null?null:l==1?t[H][Me]:t[H][1][Me],ge=N.dataIdx(n,H,d,A),Le=ge==null?null:l==1?t[H][ge]:t[H][1][ge];if(dt=dt||Le!=Ne||ge!=Me,fe[H]=ge,H>0&&be.show){let nt=ge==null?-10:ge==d?D:R(l==1?t[0][ge]:t[H][0][ge],I,_,0),Ke=Le==null?-10:G(Le,l==1?E[be.scale]:E[be.facets[1].scale],w,0);if(mn&&Le!=null){let gt=I.ori==1?_e:xe,yt=Be(Tt.dist(n,H,ge,Ke,gt));if(yt<$t){let Dt=Tt.bias;if(Dt!=0){let it=It(gt,be.scale),ht=Le>=0?1:-1,wt=it>=0?1:-1;wt==ht&&(wt==1?Dt==1?Le>=it:Le<=it:Dt==1?Le<=it:Le>=it)&&($t=yt,Vt=H)}else $t=yt,Vt=H}}if(dt||_n){let gt,yt;I.ori==0?(gt=nt,yt=Ke):(gt=Ke,yt=nt);let Dt,it,ht,wt,Bt,qe,lt=!0,nn=Ve.bbox;if(nn!=null){lt=!1;let Ye=nn(n,H);ht=Ye.left,wt=Ye.top,Dt=Ye.width,it=Ye.height}else ht=gt,wt=yt,Dt=it=Ve.size(n,H);if(qe=Ve.fill(n,H),Bt=Ve.stroke(n,H),_n)H==Vt&&$t<=Tt.prox&&(B=ht,z=wt,K=Dt,ce=it,oe=lt,te=qe,W=Bt);else{let Ye=ft[H];Ye!=null&&(vn[H]=ht,bn[H]=wt,Qs(Ye,Dt,it,lt),Ys(Ye,qe,Bt),Pt(Ye,mt(ht),mt(wt),J,P))}}}}if(_n){let H=Tt.prox,be=en==null?$t<=H:$t>H||Vt!=en;if(dt||be){let Me=ft[0];Me!=null&&(vn[0]=B,bn[0]=z,Qs(Me,K,ce,oe),Ys(Me,te,W),Pt(Me,mt(B),mt(z),J,P))}}}if(ve.show&&Ft)if(s!=null){let[x,A]=Ae.scales,[D,B]=Ae.match,[z,K]=s.cursor.sync.scales,ce=s.cursor.drag;if($e=ce._x,Oe=ce._y,$e||Oe){let{left:oe,top:te,width:W,height:H}=s.select,be=s.scales[z].ori,Me=s.posToVal,Ne,ge,Le,nt,Ke,gt=x!=null&&D(x,z),yt=A!=null&&B(A,K);gt&&$e?(be==0?(Ne=oe,ge=W):(Ne=te,ge=H),Le=E[x],nt=R(Me(Ne,z),Le,_,0),Ke=R(Me(Ne+ge,z),Le,_,0),qn(kt(nt,Ke),Be(Ke-nt))):qn(0,_),yt&&Oe?(be==1?(Ne=oe,ge=W):(Ne=te,ge=H),Le=E[A],nt=G(Me(Ne,K),Le,w,0),Ke=G(Me(Ne+ge,K),Le,w,0),Yn(kt(nt,Ke),Be(Ke-nt))):Yn(0,w)}else dl()}else{let x=Be(xs-ws),A=Be(ks-Ss);if(I.ori==1){let K=x;x=A,A=K}$e=Fe.x&&x>=Fe.dist,Oe=Fe.y&&A>=Fe.dist;let D=Fe.uni;D!=null?$e&&Oe&&($e=x>=D,Oe=A>=D,!$e&&!Oe&&(A>x?Oe=!0:$e=!0)):Fe.x&&Fe.y&&($e||Oe)&&($e=Oe=!0);let B,z;$e&&(I.ori==0?(B=Mn,z=_e):(B=Ln,z=xe),qn(kt(B,z),Be(z-B)),Oe||Yn(0,w)),Oe&&(I.ori==1?(B=Mn,z=_e):(B=Ln,z=xe),Yn(kt(B,z),Be(z-B)),$e||qn(0,_)),!$e&&!Oe&&(qn(0,0),Yn(0,0))}if(Fe._x=$e,Fe._y=Oe,s==null){if(u){if(Os!=null){let[x,A]=Ae.scales;Ae.values[0]=x!=null?It(I.ori==0?_e:xe,x):null,Ae.values[1]=A!=null?It(I.ori==1?_e:xe,A):null}Qn(pl,n,_e,xe,J,P,d)}if(mn){let x=u&&Ae.setSeries,A=Tt.prox;en==null?$t<=A&&Et(Vt,Tn,!0,x):$t>A?Et(null,Tn,!0,x):Vt!=en&&Et(Vt,Tn,!0,x)}}dt&&(ee.idx=d,al()),r!==!1&&Re("setCursor")}let Wt=null;Object.defineProperty(n,"rect",{get(){return Wt==null&&Jn(!1),Wt}});function Jn(s=!1){s?Wt=null:(Wt=S.getBoundingClientRect(),Re("syncRect",Wt))}function As(s,r,u,d,p,_,w){N._lock||Ft&&s!=null&&s.movementX==0&&s.movementY==0||(cl(s,r,u,d,p,_,w,!1,s!=null),s!=null?tn(null,!0,!0):tn(r,!0,!1))}function cl(s,r,u,d,p,_,w,x,A){if(Wt==null&&Jn(!1),Zt(s),s!=null)u=s.clientX-Wt.left,d=s.clientY-Wt.top;else{if(u<0||d<0){_e=-10,xe=-10;return}let[D,B]=Ae.scales,z=r.cursor.sync,[K,ce]=z.values,[oe,te]=z.scales,[W,H]=Ae.match,be=r.axes[0].side%2==1,Me=I.ori==0?J:P,Ne=I.ori==1?J:P,ge=be?_:p,Le=be?p:_,nt=be?d:u,Ke=be?u:d;if(oe!=null?u=W(D,oe)?g(K,E[D],Me,0):-10:u=Me*(nt/ge),te!=null?d=H(B,te)?g(ce,E[B],Ne,0):-10:d=Ne*(Ke/Le),I.ori==1){let gt=u;u=d,d=gt}}A&&(r==null||r.cursor.event.type==pl)&&((u<=1||u>=J-1)&&(u=ln(u,J)),(d<=1||d>=P-1)&&(d=ln(d,P))),x?(ws=u,Ss=d,[Mn,Ln]=N.move(n,u,d)):(_e=u,xe=d)}const ul={width:0,height:0,left:0,top:0};function dl(){bi(ul,!1)}let Ts,Es,Is,Ds;function Bs(s,r,u,d,p,_,w){Ft=!0,$e=Oe=Fe._x=Fe._y=!1,cl(s,r,u,d,p,_,w,!0,!1),s!=null&&(Ge(ml,kl,Ps,!1),Qn(Us,n,Mn,Ln,J,P,null));let{left:x,top:A,width:D,height:B}=ve;Ts=x,Es=A,Is=D,Ds=B}function Ps(s,r,u,d,p,_,w){Ft=Fe._x=Fe._y=!1,cl(s,r,u,d,p,_,w,!1,!0);let{left:x,top:A,width:D,height:B}=ve,z=D>0||B>0,K=Ts!=x||Es!=A||Is!=D||Ds!=B;if(z&&K&&bi(ve),Fe.setScale&&z&&K){let ce=x,oe=D,te=A,W=B;if(I.ori==1&&(ce=A,oe=B,te=x,W=D),$e&&Ut(C,It(ce,C),It(ce+oe,C)),Oe)for(let H in E){let be=E[H];H!=C&&be.from==null&&be.min!=he&&Ut(H,It(te+W,H),It(te,H))}dl()}else N.lock&&(N._lock=!N._lock,tn(r,!0,s!=null));s!=null&&(gn(ml,kl),Qn(ml,n,_e,xe,J,P,null))}function _a(s,r,u,d,p,_,w){if(N._lock)return;Zt(s);let x=Ft;if(Ft){let A=!0,D=!0,B=10,z,K;I.ori==0?(z=$e,K=Oe):(z=Oe,K=$e),z&&K&&(A=_e<=B||_e>=J-B,D=xe<=B||xe>=P-B),z&&A&&(_e=_e<Mn?0:J),K&&D&&(xe=xe<Ln?0:P),tn(null,!0,!0),Ft=!1}_e=-10,xe=-10,fe.fill(null),tn(null,!0,!0),x&&(Ft=x)}function zs(s,r,u,d,p,_,w){N._lock||(Zt(s),Ki(),dl(),s!=null&&Qn(js,n,_e,xe,J,P,null))}function Cs(){O.forEach(hu),Gi(n.width,n.height,!0)}on(Ti,zn,Cs);const En={};En.mousedown=Bs,En.mousemove=As,En.mouseup=Ps,En.dblclick=zs,En.setSeries=(s,r,u,d)=>{let p=Ae.match[2];u=p(n,r,u),u!=-1&&Et(u,d,!0,!1)},je&&(Ge(Us,S,Bs),Ge(pl,S,As),Ge(Vs,S,s=>{Zt(s),Jn(!1)}),Ge(Ws,S,_a),Ge(js,S,zs),Bl.add(n),n.syncRect=Jn);const yi=n.hooks=e.hooks||{};function Re(s,r,u){ll?Kn.push([s,r,u]):s in yi&&yi[s].forEach(d=>{d.call(null,n,r,u)})}(e.plugins||[]).forEach(s=>{for(let r in s.hooks)yi[r]=(yi[r]||[]).concat(s.hooks[r])});const $s=(s,r,u)=>u,Ae=Te({key:null,setSeries:!1,filters:{pub:nr,sub:nr},scales:[C,L[1]?L[1].scale:null],match:[ir,ir,$s],values:[null,null]},N.sync);Ae.match.length==2&&Ae.match.push($s),N.sync=Ae;const Os=Ae.key,fl=ao(Os);function Qn(s,r,u,d,p,_,w){Ae.filters.pub(s,r,u,d,p,_,w)&&fl.pub(s,r,u,d,p,_,w)}fl.sub(n);function va(s,r,u,d,p,_,w){Ae.filters.sub(s,r,u,d,p,_,w)&&En[s](null,r,u,d,p,_,w)}n.pub=va;function ba(){fl.unsub(n),Bl.delete(n),Kt.clear(),Al(Ti,zn,Cs),h.remove(),re==null||re.remove(),Re("destroy")}n.destroy=ba;function gl(){Re("init",e,t),gs(t||e.data,!1),V[C]?sl(C,V[C]):Ki(),gi=ve.show&&(ve.width>0||ve.height>0),Qt=dt=!0,Gi(e.width,e.height)}return L.forEach(ds),O.forEach(Qo),i?i instanceof HTMLElement?(i.appendChild(h),gl()):i(n,gl):gl(),n}Ue.assign=Te;Ue.fmtNum=Wl;Ue.rangeNum=Ei;Ue.rangeLog=zi;Ue.rangeAsinh=Ul;Ue.orient=un;Ue.pxRatio=ue;Ue.join=sc;Ue.fmtDate=Gl,Ue.tzDate=mc;Ue.sync=ao;{Ue.addGap=Zc,Ue.clipGaps=Oi;let e=Ue.paths={points:po};e.linear=_o,e.stepped=tu,e.bars=nu,e.spline=lu}const pu=["en","nl"],Mr={en:{"title.main":"VibeSensor","nav.live":"Live","nav.logs":"Logs","nav.report":"Report","nav.settings":"Settings","dashboard.run_logging":"Run Logging","dashboard.start_logging":"Start Logging","dashboard.stop_logging":"Stop Logging","dashboard.speed_override":"Speed Override (km/h)","dashboard.apply_override":"Apply Override","dashboard.detected_vibrations":"Detected Vibrations","dashboard.vibration_count_live":"Vibration Count Live","dashboard.matrix_note":"Levels use peak-over-floor dB bands (L1-L5), grouped by source type.","logs.refresh":"Refresh Logs","logs.table.file":"File","logs.table.updated":"Updated","logs.table.size":"Size","logs.table.actions":"Actions","logs.none":"No log files yet.","logs.none_found":"No logs found.","logs.available_count":"{count} log file(s) available","logs.use_in_report":"Use In Report","logs.generate_pdf":"Generate PDF","logs.generating_pdf":"Generating...","logs.pdf_failed":"Failed to generate PDF.","logs.raw":"Raw","logs.delete":"Delete","logs.delete_all":"Delete All Logs","logs.no_available":"No logs available","logs.delete_confirm":'Delete log "{name}"? This cannot be undone.',"logs.delete_all_confirm":"Delete all {count} log file(s)? This cannot be undone.","logs.delete_failed":"Failed to delete log.","logs.delete_all_partial":"Deleted {deleted} of {total} logs. {failed} failed.","logs.loading_preview":"Loading run preview...","logs.preview_unavailable":"Preview is unavailable for this run.","logs.preview_heatmap_title":"Preview heatmap (p95 intensity)","logs.preview_stats_title":"Sensor statistics","logs.load_insights":"Load insights","logs.reload_insights":"Reload insights","logs.loading_insights":"Loading insights...","logs.summary_created":"Created","logs.summary_updated":"Updated","logs.summary_size":"File size","logs.summary_sensor_count":"Sensors","logs.not_available":"n/a","logs.table.location":"Location","logs.table.samples":"Samples","logs.table.dropped_delta":"Dropped ","logs.table.overflow_delta":"Overflow ","report.saved_run":"Saved run","report.load_insights":"Load Insights","report.generate_pdf":"Generate PDF Report","report.select_run_hint":"Select a saved run and click <strong>Load Insights</strong>.","report.no_insights":"No report insights available for this run.","report.unable_load_insights":"Unable to load insights for selected log.","report.file":"File","report.run_id":"Run ID","report.duration":"Duration","report.rows":"Rows","report.raw_sample_rate":"Raw sample rate","report.speed_coverage":"Speed coverage","report.speed_analysis":"Speed analysis","report.confidence":"confidence {value}","report.missing":"missing","report.no_findings_for_run":"No findings generated for this run.","settings.client_locations":"Client Locations","settings.client_locations_hint":"Set location and identify by client. Offline clients can still be assigned.","settings.clients.client":"Client","settings.clients.mac":"MAC Address","settings.clients.location":"Location","settings.clients.identify":"Identify","settings.clients.remove":"Remove","settings.group.vehicle_setup":"Vehicle Setup","settings.group.order_band_widths":"Order Band Widths","settings.group.uncertainty_model":"Uncertainty Model","settings.uncertainty_defaults":"Defaults use tire wear from 10/32 in to 2/32 in plus safety margin.","settings.tire_width":"Tire Width (mm)","settings.tire_aspect":"Tire Aspect (%)","settings.rim_size":"Rim Size (in)","settings.final_drive_ratio":"Final Drive Ratio","settings.current_gear_ratio":"Current Gear Ratio","settings.wheel_bandwidth":"Wheel Bandwidth (%)","settings.driveshaft_bandwidth":"Driveshaft Bandwidth (%)","settings.engine_bandwidth":"Engine Bandwidth (%)","settings.min_half_width":"Min Half-width (Hz)","settings.max_half_width":"Max Half-width (%)","settings.speed_uncertainty":"Speed Uncertainty (%)","settings.tire_diameter_uncertainty":"Tire Diameter Uncertainty (%)","settings.final_drive_uncertainty":"Final Drive Uncertainty (%)","settings.gear_slip_uncertainty":"Gear/Slip Uncertainty (%)","settings.save":"Save Settings","settings.no_clients":"No clients detected yet.","settings.select_location":"Select location","status.online":"Online","status.offline":"Offline","status.last_seen":"Last seen: {value}","status.last_seen_none":"Last seen: --","status.dropped":"Dropped frames: {value}","status.frames_total":"Frames total: {value}","status.last_seen_label":"Last seen","status.dropped_label":"Dropped frames","status.frames_total_label":"Frames total","status.running":"Running","status.stopped":"Stopped","status.unavailable":"Unavailable","status.current_file":"Current file: {value}","speed.gps":"Speed: {value} {unit} (GPS)","speed.override":"Speed: {value} {unit} (Override)","speed.none":"Speed: -- {unit}","speed.unit":"Unit","speed.unit.kmh":"km/h","speed.unit.mps":"m/s","ws.connecting":"WS: connecting...","ws.connected":"WS: connected","ws.reconnecting":"WS: reconnecting...","ws.stale":"WS: stale data","ws.no_data":"WS: connected, no data yet","spectrum.loading":"Loading spectrum...","spectrum.disconnected":"Disconnected. Waiting for websocket.","spectrum.stale":"Data is stale. Waiting for fresh frames.","spectrum.empty":"Connected, but no spectrum frames yet.","actions.identify":"Identify","actions.remove":"Remove","actions.remove_client_confirm":"Remove client {id} from the list?","actions.remove_client_failed":"Failed to remove client.","actions.set_location_failed":"Failed to set location.","vibration.none":"No significant vibration events yet.","matrix.amplitude_group":"Amplitude Group","matrix.source.engine":"Engine","matrix.source.driveshaft":"Drive Shaft","matrix.source.wheel":"Wheel/Tire","matrix.source.other":"Other/Road","matrix.severity.l5":"L5 Critical (>=34 dB)","matrix.severity.l4":"L4 Severe (28-34 dB)","matrix.severity.l3":"L3 Elevated (22-28 dB)","matrix.severity.l2":"L2 Moderate (16-22 dB)","matrix.severity.l1":"L1 Slight (10-16 dB)","tooltip.no_events":"No events yet.","tooltip.total_events":"Total events: {count}","tooltip.by_sensor_scope":"By sensor scope:","chart.spectrum_title":"Multi-Sensor Blended Spectrum","chart.axis.hz":"Hz","chart.axis.amplitude":"Amplitude (dB)","bands.wheel_1x":"Wheel 1x","bands.wheel_2x":"Wheel 2x","bands.driveshaft_engine_1x":"Driveshaft+Engine 1x","bands.driveshaft_1x":"Driveshaft 1x","bands.engine_1x":"Engine 1x","bands.engine_2x":"Engine 2x","cause.wheel1":"Wheel/Tire imbalance or radial force variation","cause.wheel2":"Tire non-uniformity or wheel resonance","cause.shaft_eng1":"Driveshaft/Engine 1x overlap (same order in current gear)","cause.shaft1":"Drive shaft imbalance or driveline angle issue","cause.eng1":"Engine order vibration (mount/combustion/accessory related)","cause.eng2":"Engine second-order vibration (common in 4-cylinder NVH)","cause.road":"Road input / suspension or body resonance","cause.other":"Further diagnostics needed","msg.multi_detected":"Strong multi-sensor vibration detected on {count} sensors [{labels}]. Frequency and amplitude are {hz} Hz and {amp}. Severity: {severity}. Most likely cause: {cause}.","msg.single_detected":"Vibration detected by sensor {sensor}. Frequency and amplitude are {hz} Hz and {amp}. Severity: {severity}. Most likely cause: {cause}.","location.front_left_wheel":"Front Left Wheel","location.front_right_wheel":"Front Right Wheel","location.rear_left_wheel":"Rear Left Wheel","location.rear_right_wheel":"Rear Right Wheel","location.transmission":"Transmission","location.driveshaft_tunnel":"Driveshaft Tunnel","location.engine_bay":"Engine Bay","location.front_subframe":"Front Subframe","location.rear_subframe":"Rear Subframe","location.driver_seat":"Driver Seat","location.front_passenger_seat":"Front Passenger Seat","location.rear_left_seat":"Rear Left Seat","location.rear_center_seat":"Rear Center Seat","location.rear_right_seat":"Rear Right Seat","location.trunk":"Trunk"},nl:{"title.main":"VibeSensor","nav.live":"Live","nav.logs":"Logs","nav.report":"Rapport","nav.settings":"Instellingen","dashboard.run_logging":"Metrun loggen","dashboard.start_logging":"Logging starten","dashboard.stop_logging":"Logging stoppen","dashboard.speed_override":"Snelheid forceren (km/u)","dashboard.apply_override":"Forcering toepassen","dashboard.detected_vibrations":"Gedetecteerde trillingen","dashboard.vibration_count_live":"Live trillingsteller","dashboard.matrix_note":"Niveaus gebruiken dB-banden boven de ruisvloer (L1-L5), gegroepeerd per bron.","logs.refresh":"Logs verversen","logs.table.file":"Bestand","logs.table.updated":"Bijgewerkt","logs.table.size":"Grootte","logs.table.actions":"Acties","logs.none":"Nog geen logbestanden.","logs.none_found":"Geen logs gevonden.","logs.available_count":"{count} logbestand(en) beschikbaar","logs.use_in_report":"Gebruik in rapport","logs.generate_pdf":"PDF genereren","logs.generating_pdf":"Genereren...","logs.pdf_failed":"Genereren van PDF is mislukt.","logs.raw":"RAW-log","logs.delete":"Verwijderen","logs.delete_all":"Alle logs verwijderen","logs.no_available":"Geen logs beschikbaar","logs.delete_confirm":'Log "{name}" verwijderen? Dit kan niet ongedaan worden gemaakt.',"logs.delete_all_confirm":"Alle {count} logbestand(en) verwijderen? Dit kan niet ongedaan worden gemaakt.","logs.delete_failed":"Verwijderen van log is mislukt.","logs.delete_all_partial":"{deleted} van {total} logs verwijderd. {failed} mislukt.","logs.loading_preview":"Run-preview laden...","logs.preview_unavailable":"Preview is niet beschikbaar voor deze run.","logs.preview_heatmap_title":"Preview-heatmap (p95 intensiteit)","logs.preview_stats_title":"Sensorstatistieken","logs.load_insights":"Inzichten laden","logs.reload_insights":"Inzichten herladen","logs.loading_insights":"Inzichten laden...","logs.summary_created":"Aangemaakt","logs.summary_updated":"Bijgewerkt","logs.summary_size":"Bestandsgrootte","logs.summary_sensor_count":"Sensoren","logs.not_available":"n.v.t.","logs.table.location":"Locatie","logs.table.samples":"Samples","logs.table.dropped_delta":"Verlies ","logs.table.overflow_delta":"Overflow ","report.saved_run":"Opgeslagen meetrun","report.load_insights":"Inzichten laden","report.generate_pdf":"PDF-rapport genereren","report.select_run_hint":"Selecteer een opgeslagen meetrun en klik op <strong>Inzichten laden</strong>.","report.no_insights":"Geen rapportinzichten beschikbaar voor deze meetrun.","report.unable_load_insights":"Kan inzichten voor de geselecteerde log niet laden.","report.file":"Bestand","report.run_id":"Run-ID","report.duration":"Duur","report.rows":"Rijen","report.raw_sample_rate":"Bemonsteringsfrequentie","report.speed_coverage":"Snelheidsdekking","report.speed_analysis":"Snelheidsanalyse","report.confidence":"score {value}","report.missing":"ontbreekt","report.no_findings_for_run":"Geen bevindingen gegenereerd voor deze meetrun.","settings.client_locations":"Sensorlocaties","settings.client_locations_hint":"Stel per sensor een locatie in en identificeer. Offline sensoren kunnen ook toegewezen worden.","settings.clients.client":"Sensor","settings.clients.mac":"MAC-adres","settings.clients.location":"Locatie","settings.clients.identify":"Identificeer","settings.clients.remove":"Verwijder","settings.group.vehicle_setup":"Voertuiggegevens","settings.group.order_band_widths":"Ordebandbreedtes","settings.group.uncertainty_model":"Onzekerheidsmodel","settings.uncertainty_defaults":"Standaardwaarden gebruiken bandenslijtage van 10/32 in tot 2/32 in plus veiligheidsmarge.","settings.tire_width":"Bandbreedte (mm)","settings.tire_aspect":"Bandenprofiel (%)","settings.rim_size":"Velgmaat (inch)","settings.final_drive_ratio":"Eindoverbrenging","settings.current_gear_ratio":"Huidige overbrengingsverhouding","settings.wheel_bandwidth":"Bandbreedte wielorde (%)","settings.driveshaft_bandwidth":"Bandbreedte aandrijfasorde (%)","settings.engine_bandwidth":"Bandbreedte motororde (%)","settings.min_half_width":"Min halve breedte (Hz)","settings.max_half_width":"Max halve breedte (%)","settings.speed_uncertainty":"Snelheidsonzekerheid (%)","settings.tire_diameter_uncertainty":"Banddiameteronzekerheid (%)","settings.final_drive_uncertainty":"Onzekerheid eindoverbrenging (%)","settings.gear_slip_uncertainty":"Versnellings-/sliponzekerheid (%)","settings.save":"Instellingen opslaan","settings.no_clients":"Nog geen sensoren gedetecteerd.","settings.select_location":"Selecteer locatie","status.online":"Online","status.offline":"Offline","status.last_seen":"Laatst gezien: {value}","status.last_seen_none":"Laatst gezien: --","status.dropped":"Verloren frames: {value}","status.frames_total":"Totaal frames: {value}","status.last_seen_label":"Laatst gezien","status.dropped_label":"Verloren frames","status.frames_total_label":"Totaal frames","status.running":"Actief","status.stopped":"Gestopt","status.unavailable":"Niet beschikbaar","status.current_file":"Huidig bestand: {value}","speed.gps":"Snelheid: {value} {unit} (GPS)","speed.override":"Snelheid: {value} {unit} (Geforceerd)","speed.none":"Snelheid: -- {unit}","speed.unit":"Snelheidseenheid","speed.unit.kmh":"km/u","speed.unit.mps":"m/s","ws.connecting":"WS: verbinden...","ws.connected":"WS: verbonden","ws.reconnecting":"WS: opnieuw verbinden...","ws.stale":"WS: verouderde data","ws.no_data":"WS: verbonden, nog geen data","spectrum.loading":"Spectrum laden...","spectrum.disconnected":"Verbinding weg. Wachten op websocket.","spectrum.stale":"Data is verouderd. Wachten op nieuwe frames.","spectrum.empty":"Verbonden, maar nog geen spectrumdata.","actions.identify":"Identificeer","actions.remove":"Verwijder","actions.remove_client_confirm":"Sensor {id} uit de lijst verwijderen?","actions.remove_client_failed":"Verwijderen van sensor is mislukt.","actions.set_location_failed":"Instellen van locatie is mislukt.","vibration.none":"Nog geen noemenswaardige trillingen.","matrix.amplitude_group":"Amplitudegroep","matrix.source.engine":"Motor","matrix.source.driveshaft":"Aandrijfas","matrix.source.wheel":"Wiel/Band","matrix.source.other":"Overig/Weg","matrix.severity.l5":"L5 Kritiek (>=34 dB)","matrix.severity.l4":"L4 Ernstig (28-34 dB)","matrix.severity.l3":"L3 Verhoogd (22-28 dB)","matrix.severity.l2":"L2 Matig (16-22 dB)","matrix.severity.l1":"L1 Licht (10-16 dB)","tooltip.no_events":"Nog geen gebeurtenissen.","tooltip.total_events":"Totaal gebeurtenissen: {count}","tooltip.by_sensor_scope":"Per sensorbereik:","chart.spectrum_title":"Gemengd spectrum van meerdere sensoren","chart.axis.hz":"Hz","chart.axis.amplitude":"Amplitude (dB)","bands.wheel_1x":"Wiel 1x","bands.wheel_2x":"Wiel 2x","bands.driveshaft_engine_1x":"Aandrijfas+Motor 1x","bands.driveshaft_1x":"Aandrijfas 1x","bands.engine_1x":"Motor 1x","bands.engine_2x":"Motor 2x","cause.wheel1":"Wiel/band-onbalans of radiale krachtvariatie","cause.wheel2":"Band-niet-uniformiteit of wielresonantie","cause.shaft_eng1":"Aandrijfas/motor 1x overlap (zelfde orde in huidige versnelling)","cause.shaft1":"Aandrijfas-onbalans of aandrijflijnhoekprobleem","cause.eng1":"Motororde-trilling (steun/verbranding/accessoire-gerelateerd)","cause.eng2":"Tweede orde motortrilling (vaak bij 4-cilinder NVH)","cause.road":"Weginput / ophanging of carrosserieresonantie","cause.other":"Verdere diagnose nodig","msg.multi_detected":"Sterke multi-sensor trilling gedetecteerd op {count} sensoren [{labels}]. Frequentie en amplitude zijn {hz} Hz en {amp}. Ernst: {severity}. Meest waarschijnlijke oorzaak: {cause}.","msg.single_detected":"Trilling gedetecteerd door sensor {sensor}. Frequentie en amplitude zijn {hz} Hz en {amp}. Ernst: {severity}. Meest waarschijnlijke oorzaak: {cause}.","location.front_left_wheel":"Voorwiel links","location.front_right_wheel":"Voorwiel rechts","location.rear_left_wheel":"Achterwiel links","location.rear_right_wheel":"Achterwiel rechts","location.transmission":"Transmissie","location.driveshaft_tunnel":"Cardantunnel","location.engine_bay":"Motorruimte","location.front_subframe":"Voorste subframe","location.rear_subframe":"Achterste subframe","location.driver_seat":"Bestuurdersstoel","location.front_passenger_seat":"Voorpassagiersstoel","location.rear_left_seat":"Achterstoel links","location.rear_center_seat":"Achterstoel midden","location.rear_right_seat":"Achterstoel rechts","location.trunk":"Kofferbak"}};function Xl(e){return String(e||"").trim().toLowerCase().startsWith("nl")?"nl":"en"}function mu(e,t){return!t||typeof t!="object"?e:String(e).replace(/\{([a-zA-Z0-9_]+)\}/g,(i,n)=>Object.prototype.hasOwnProperty.call(t,n)?String(t[n]):`{${n}}`)}function es(e,t,i){var a,g;const n=Xl(e),l=((a=Mr.en)==null?void 0:a[t])||t,o=((g=Mr[n])==null?void 0:g[t])||l;return mu(o,i)}function _u(e){return pu.map(t=>es(t,e))}async function at(e,t){const i=await fetch(e,t);if(!i.ok){let n=`${i.status} ${i.statusText}`;try{const l=await i.json();l&&typeof l.detail=="string"&&(n=l.detail)}catch{}throw new Error(n)}return i.json()}function vu(e){return`/api/logs/${encodeURIComponent(e)}`}function bu(e,t){return`/api/logs/${encodeURIComponent(e)}/report.pdf?lang=${encodeURIComponent(t)}`}async function yu(){return at("/api/client-locations")}async function wu(){return at("/api/speed-override")}async function Su(e){return at("/api/speed-override",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({speed_kmh:e})})}async function xu(e){return at("/api/analysis-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function ku(){return at("/api/logging/status")}async function Mu(){return at("/api/logging/start",{method:"POST"})}async function Lu(){return at("/api/logging/stop",{method:"POST"})}async function Au(){return at("/api/logs")}async function Tu(e){await at(`/api/logs/${encodeURIComponent(e)}`,{method:"DELETE"})}async function wo(e,t,i=!1){return at(`/api/logs/${encodeURIComponent(e)}/insights?lang=${encodeURIComponent(t)}&include_samples=${i?"1":"0"}`)}async function Eu(e,t){return at(`/api/clients/${encodeURIComponent(e)}/location`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location_code:t})})}async function Iu(e,t=1500){return at(`/api/clients/${encodeURIComponent(e)}/identify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({duration_ms:t})})}async function Du(e){return at(`/api/clients/${encodeURIComponent(e)}`,{method:"DELETE"})}const Bu=["#0b57d0","#0f9d58","#9334e6","#ef6c00","#c5221f","#007b83","#8e6c00"],Dn={wheel1:"rgba(15,157,88,0.16)",wheel2:"rgba(15,157,88,0.12)",driveshaft1:"rgba(11,87,208,0.14)",engine1:"rgba(197,34,31,0.14)",engine2:"rgba(197,34,31,0.11)",driveshaftEngine1:"rgba(112,86,166,0.16)"},Lr=Bu,zl=["front_left_wheel","front_right_wheel","rear_left_wheel","rear_right_wheel","transmission","driveshaft_tunnel","engine_bay","front_subframe","rear_subframe","driver_seat","front_passenger_seat","rear_left_seat","rear_center_seat","rear_right_seat","trunk"],ri=2,wl={new_tread_mm:7.9,worn_tread_mm:1.6,safety_margin_pct:.3},Di=[{key:"engine",labelKey:"matrix.source.engine"},{key:"driveshaft",labelKey:"matrix.source.driveshaft"},{key:"wheel",labelKey:"matrix.source.wheel"},{key:"other",labelKey:"matrix.source.other"}],So=[{key:"l1",min_db:10,min_amp:.003},{key:"l2",min_db:16,min_amp:.006},{key:"l3",min_db:22,min_amp:.012},{key:"l4",min_db:28,min_amp:.024},{key:"l5",min_db:34,min_amp:.048}],Pu=500,zu=1.5;class Cu{constructor(t,i,n=360,l){this.plot=null,this.resizeObserver=null,this.resizeRaf=null,this.hostEl=t,this.measureEl=l||t,this.overlayEl=i||null,this.height=n,this.startResizeObserver()}ensurePlot(t,i,n=[]){if(this.plot&&this.plot.series.length===t.length+1)return;this.destroyPlot();const l=[{label:"Hz"}];for(const o of t)l.push({label:o.label,stroke:o.color,width:2});this.plot=new Ue({title:"",width:this.computeWidth(),height:this.height,scales:{x:{time:!1},y:{range:[0,50]}},axes:[{label:i.axisHz,stroke:this.cssVar("--muted","#5a6b82"),grid:{stroke:this.cssVar("--border","#d7e1ee"),width:1}},{label:i.axisAmplitude,stroke:this.cssVar("--muted","#5a6b82"),grid:{stroke:this.cssVar("--border","#d7e1ee"),width:1}}],series:l,plugins:n},[[]],this.hostEl)}setData(t){this.plot&&this.plot.setData(t)}resize(){this.plot&&this.plot.setSize({width:this.computeWidth(),height:this.height})}getSeriesCount(){return this.plot?this.plot.series.length:0}renderLegend(t,i){t.innerHTML="";for(const n of i){const l=document.createElement("div");l.className="legend-item",l.innerHTML=`<span class="swatch" style="--swatch-color:${n.color}"></span><span>${n.label}</span>`,t.appendChild(l)}}setOverlay(t){if(this.overlayEl){if(!t){this.overlayEl.hidden=!0,this.overlayEl.textContent="";return}this.overlayEl.hidden=!1,this.overlayEl.textContent=t}}destroy(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.resizeRaf!==null&&(window.cancelAnimationFrame(this.resizeRaf),this.resizeRaf=null),this.destroyPlot()}destroyPlot(){this.plot&&(this.plot.destroy(),this.plot=null)}startResizeObserver(){this.resizeObserver=new ResizeObserver(()=>{this.resizeRaf!==null&&window.cancelAnimationFrame(this.resizeRaf),this.resizeRaf=window.requestAnimationFrame(()=>{this.resizeRaf=null,this.resize()})}),this.resizeObserver.observe(this.measureEl)}cssVar(t,i){return getComputedStyle(document.documentElement).getPropertyValue(t).trim()||i}computeWidth(){return Math.max(320,Math.floor(this.measureEl.getBoundingClientRect().width))}}function ts(e){const t=Array.isArray(e)?e.map(l=>{if(!l||typeof l!="object")return null;const o=String(l.key||"").toLowerCase(),a=Number(l.min_db),g=Number(l.min_amp);return!o||!Number.isFinite(a)||!Number.isFinite(g)?null:{key:o,min_db:a,min_amp:g}}).filter(l=>l!==null):[],n=[...t.length?t:So].sort((l,o)=>l.min_db-o.min_db);return n.map((l,o)=>({...l,max_db:o+1<n.length?n[o+1].min_db:Number.POSITIVE_INFINITY,labelKey:`matrix.severity.${l.key}`}))}function ns(e=ts(So)){const t={},i=[...e].sort((n,l)=>l.min_db-n.min_db);for(const n of Di){t[n.key]={};for(const l of i)t[n.key][l.key]={count:0,seconds:0,contributors:{}}}return t}function Ar(e){return e==="shaft_eng1"?["driveshaft","engine"]:e==="eng1"||e==="eng2"?["engine"]:e==="shaft1"?["driveshaft"]:e==="wheel1"||e==="wheel2"?["wheel"]:["other"]}function $u(e,t){const i=Math.max(0,e),n=Math.max(0,t),l=Math.max(1e-9,n*.05);return 20*Math.log10((i+l)/(n+l))}function Tr(e,t,i,n){const l=$u(e,t),o=i>=2?l+3:l;for(const a of[...n].sort((g,f)=>f.min_db-g.min_db)){const g=Number.isFinite(a.max_db)?Number(a.max_db):Number.POSITIVE_INFINITY;if(o>=a.min_db&&o<g&&e>=a.min_amp)return{key:a.key,labelKey:a.labelKey||`matrix.severity.${a.key}`,db:o}}return null}class Ou{constructor(t){this.ws=null,this.state="connecting",this.reconnectTimer=null,this.staleTimer=null,this.lastMessageAtMs=0,this.lastServerTimeMs=0,this.hasData=!1,this.manuallyClosed=!1,this.options={staleAfterMs:3e3,reconnectDelayMs:1200,hasData:i=>{var l;const n=(l=i==null?void 0:i.spectra)==null?void 0:l.clients;return!n||typeof n!="object"?!1:Object.keys(n).length>0},...t}}connect(){this.manuallyClosed=!1,this.open("connecting"),this.staleTimer===null&&(this.staleTimer=window.setInterval(()=>this.tickStale(),1e3))}close(){this.manuallyClosed=!0,this.reconnectTimer!==null&&(window.clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.staleTimer!==null&&(window.clearInterval(this.staleTimer),this.staleTimer=null),this.ws&&(this.ws.close(),this.ws=null)}send(t){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(t))}open(t){this.setState(t),this.hasData=!1,this.lastMessageAtMs=0,this.lastServerTimeMs=0,this.ws=new WebSocket(this.options.url),this.ws.onopen=()=>{this.setState("no_data")},this.ws.onmessage=i=>{let n;try{n=JSON.parse(i.data)}catch{return}const l=Date.now();this.lastMessageAtMs=l;const o=Date.parse(String((n==null?void 0:n.server_time)||""));this.lastServerTimeMs=Number.isFinite(o)?o:l,this.hasData=this.hasData||this.options.hasData(n),this.setState(this.hasData?"connected":"no_data"),this.options.onPayload(n)},this.ws.onclose=()=>{this.ws=null,!this.manuallyClosed&&(this.setState("reconnecting"),this.scheduleReconnect())},this.ws.onerror=()=>{}}scheduleReconnect(){this.reconnectTimer!==null&&window.clearTimeout(this.reconnectTimer),this.reconnectTimer=window.setTimeout(()=>{this.reconnectTimer=null,this.open("reconnecting")},this.options.reconnectDelayMs)}tickStale(){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)return;if(!this.hasData||this.lastMessageAtMs<=0){this.setState("no_data");return}const t=this.lastServerTimeMs>0?this.lastServerTimeMs:this.lastMessageAtMs;Date.now()-t>this.options.staleAfterMs&&this.setState("stale")}setState(t){this.state!==t&&(this.state=t,this.options.onStateChange(t))}}const y={menuButtons:Array.from(document.querySelectorAll(".menu-btn")),views:Array.from(document.querySelectorAll(".view")),languageSelect:document.getElementById("languageSelect"),speedUnitSelect:document.getElementById("speedUnitSelect"),speed:document.getElementById("speed"),loggingStatus:document.getElementById("loggingStatus"),currentLogFile:document.getElementById("currentLogFile"),startLoggingBtn:document.getElementById("startLoggingBtn"),stopLoggingBtn:document.getElementById("stopLoggingBtn"),refreshLogsBtn:document.getElementById("refreshLogsBtn"),logsSummary:document.getElementById("logsSummary"),logsTableBody:document.getElementById("logsTableBody"),clientsSettingsBody:document.getElementById("clientsSettingsBody"),lastSeen:document.getElementById("lastSeen"),dropped:document.getElementById("dropped"),framesTotal:document.getElementById("framesTotal"),linkState:document.getElementById("linkState"),specChartWrap:document.getElementById("specChartWrap"),specChart:document.getElementById("specChart"),spectrumOverlay:document.getElementById("spectrumOverlay"),legend:document.getElementById("legend"),bandLegend:document.getElementById("bandLegend"),strengthChart:document.getElementById("strengthChart"),strengthTooltip:document.getElementById("strengthTooltip"),tireWidthInput:document.getElementById("tireWidthInput"),tireAspectInput:document.getElementById("tireAspectInput"),rimInput:document.getElementById("rimInput"),finalDriveInput:document.getElementById("finalDriveInput"),gearRatioInput:document.getElementById("gearRatioInput"),wheelBandwidthInput:document.getElementById("wheelBandwidthInput"),driveshaftBandwidthInput:document.getElementById("driveshaftBandwidthInput"),engineBandwidthInput:document.getElementById("engineBandwidthInput"),speedUncertaintyInput:document.getElementById("speedUncertaintyInput"),tireDiameterUncertaintyInput:document.getElementById("tireDiameterUncertaintyInput"),finalDriveUncertaintyInput:document.getElementById("finalDriveUncertaintyInput"),gearUncertaintyInput:document.getElementById("gearUncertaintyInput"),minAbsBandHzInput:document.getElementById("minAbsBandHzInput"),maxBandHalfWidthInput:document.getElementById("maxBandHalfWidthInput"),speedOverrideInput:document.getElementById("speedOverrideInput"),applySpeedOverrideBtn:document.getElementById("applySpeedOverrideBtn"),saveSettingsBtn:document.getElementById("saveSettingsBtn"),vibrationLog:document.getElementById("vibrationLog"),vibrationMatrix:document.getElementById("vibrationMatrix"),matrixTooltip:document.getElementById("matrixTooltip")},xo="vibesensor_ui_lang_v1",ko="vibesensor_vehicle_settings_v3",Mo="vibesensor_speed_unit",c={ws:null,wsState:"connecting",lang:Xl(window.localStorage.getItem(xo)||"en"),speedUnit:Lo(window.localStorage.getItem(Mo)||"kmh"),clients:[],selectedClientId:null,spectrumPlot:null,spectra:{freq:[],clients:{}},speedMps:null,activeViewId:"dashboardView",logs:[],expandedLogName:null,logDetailsByName:{},loggingStatus:{enabled:!1,current_file:null},locationOptions:[],vehicleSettings:{tire_width_mm:285,tire_aspect_pct:30,rim_in:21,final_drive_ratio:3.08,current_gear_ratio:.64,wheel_bandwidth_pct:6,driveshaft_bandwidth_pct:5.6,engine_bandwidth_pct:6.2,speed_uncertainty_pct:.6,tire_diameter_uncertainty_pct:1.2,final_drive_uncertainty_pct:.2,gear_uncertainty_pct:.5,min_abs_band_hz:.4,max_band_half_width_pct:8,band_tolerance_model_version:ri,speed_override_kmh:100,event_min_abs_peak_g:.01,event_peak_floor_ratio:3,event_db_floor_eps_ratio:.05},chartBands:[],vibrationMessages:[],lastDetectionByClient:{},lastDetectionGlobal:{},recentDetectionEvents:[],strengthBands:ts([]),eventMatrix:ns(),pendingPayload:null,renderQueued:!1,lastRenderTsMs:0,minRenderIntervalMs:100,clientsSettingsSignature:"",locationCodes:zl.slice(),hasSpectrumData:!1,hasReceivedPayload:!1,useServerDiagnostics:!1,strengthPlot:null,strengthHoverText:"",strengthHistory:{t:[],wheel:[],driveshaft:[],engine:[],other:[]}};function k(e,t){return es(c.lang,e,t)}function Lo(e){return e==="mps"?"mps":"kmh"}function Ru(e){c.speedUnit=Lo(e),window.localStorage.setItem(Mo,c.speedUnit)}function Er(e){return typeof e!="number"||!Number.isFinite(e)?null:c.speedUnit==="mps"?e:e*3.6}function Nu(){return c.speedUnit==="mps"?k("speed.unit.mps"):k("speed.unit.kmh")}function Hu(e,t){return es(e,`location.${t}`,{code:t})}function Fu(e){return Hu(c.lang,e)}function Cl(e){return e.map(t=>({code:t,label:Fu(t)}))}function Uu(){document.documentElement.lang=c.lang,document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");t&&(e.innerHTML=k(t))})}function Vu(e){c.lang=Xl(e),window.localStorage.setItem(xo,c.lang)}function Ao(e=!1){var t;if(Uu(),y.languageSelect&&(y.languageSelect.value=c.lang),y.speedUnitSelect&&(y.speedUnitSelect.value=c.speedUnit),c.locationOptions=Cl(c.locationCodes),c.clientsSettingsSignature="",ci(!0),Vn(),Fi(),Mt(),Fo(),Vi(),Po(),c.spectrumPlot&&(c.spectrumPlot.destroy(),c.spectrumPlot=null,Wi()),e&&c.expandedLogName){const i=c.expandedLogName,n=(t=c.logDetailsByName)==null?void 0:t[i],l=!!(n!=null&&n.insights);delete c.logDetailsByName[i],No(i,!0).then(()=>{l&&Ho(i,!0)})}oi()}Object.assign(c.vehicleSettings,Do(c.vehicleSettings));function Wu(){try{const e=window.localStorage.getItem(ko);if(!e)return;const t=JSON.parse(e);if(typeof t!="object"||!t)return;typeof t.tire_width_mm=="number"&&(c.vehicleSettings.tire_width_mm=t.tire_width_mm),typeof t.tire_aspect_pct=="number"&&(c.vehicleSettings.tire_aspect_pct=t.tire_aspect_pct),typeof t.rim_in=="number"&&(c.vehicleSettings.rim_in=t.rim_in),typeof t.final_drive_ratio=="number"&&(c.vehicleSettings.final_drive_ratio=t.final_drive_ratio),typeof t.current_gear_ratio=="number"&&(c.vehicleSettings.current_gear_ratio=t.current_gear_ratio),typeof t.wheel_bandwidth_pct=="number"&&(c.vehicleSettings.wheel_bandwidth_pct=t.wheel_bandwidth_pct),typeof t.driveshaft_bandwidth_pct=="number"&&(c.vehicleSettings.driveshaft_bandwidth_pct=t.driveshaft_bandwidth_pct),typeof t.engine_bandwidth_pct=="number"&&(c.vehicleSettings.engine_bandwidth_pct=t.engine_bandwidth_pct),typeof t.speed_uncertainty_pct=="number"&&(c.vehicleSettings.speed_uncertainty_pct=t.speed_uncertainty_pct),typeof t.tire_diameter_uncertainty_pct=="number"&&(c.vehicleSettings.tire_diameter_uncertainty_pct=t.tire_diameter_uncertainty_pct),typeof t.final_drive_uncertainty_pct=="number"&&(c.vehicleSettings.final_drive_uncertainty_pct=t.final_drive_uncertainty_pct),typeof t.gear_uncertainty_pct=="number"&&(c.vehicleSettings.gear_uncertainty_pct=t.gear_uncertainty_pct),typeof t.min_abs_band_hz=="number"&&(c.vehicleSettings.min_abs_band_hz=t.min_abs_band_hz),typeof t.max_band_half_width_pct=="number"&&(c.vehicleSettings.max_band_half_width_pct=t.max_band_half_width_pct),typeof t.band_tolerance_model_version=="number"&&(c.vehicleSettings.band_tolerance_model_version=t.band_tolerance_model_version),typeof t.speed_override_kmh=="number"&&(c.vehicleSettings.speed_override_kmh=t.speed_override_kmh),typeof t.event_min_abs_peak_g=="number"&&(c.vehicleSettings.event_min_abs_peak_g=t.event_min_abs_peak_g),typeof t.event_peak_floor_ratio=="number"&&(c.vehicleSettings.event_peak_floor_ratio=t.event_peak_floor_ratio),typeof t.event_db_floor_eps_ratio=="number"&&(c.vehicleSettings.event_db_floor_eps_ratio=t.event_db_floor_eps_ratio),(c.vehicleSettings.band_tolerance_model_version||0)<ri&&Object.assign(c.vehicleSettings,Do(c.vehicleSettings)),c.vehicleSettings.band_tolerance_model_version=ri}catch{}}function is(){window.localStorage.setItem(ko,JSON.stringify(c.vehicleSettings))}function To(){y.tireWidthInput.value=String(c.vehicleSettings.tire_width_mm),y.tireAspectInput.value=String(c.vehicleSettings.tire_aspect_pct),y.rimInput.value=String(c.vehicleSettings.rim_in),y.finalDriveInput.value=String(c.vehicleSettings.final_drive_ratio),y.gearRatioInput.value=String(c.vehicleSettings.current_gear_ratio),y.wheelBandwidthInput.value=String(c.vehicleSettings.wheel_bandwidth_pct),y.driveshaftBandwidthInput.value=String(c.vehicleSettings.driveshaft_bandwidth_pct),y.engineBandwidthInput.value=String(c.vehicleSettings.engine_bandwidth_pct),y.speedUncertaintyInput.value=String(c.vehicleSettings.speed_uncertainty_pct),y.tireDiameterUncertaintyInput.value=String(c.vehicleSettings.tire_diameter_uncertainty_pct),y.finalDriveUncertaintyInput.value=String(c.vehicleSettings.final_drive_uncertainty_pct),y.gearUncertaintyInput.value=String(c.vehicleSettings.gear_uncertainty_pct),y.minAbsBandHzInput.value=String(c.vehicleSettings.min_abs_band_hz),y.maxBandHalfWidthInput.value=String(c.vehicleSettings.max_band_half_width_pct),y.speedOverrideInput.value=String(c.vehicleSettings.speed_override_kmh)}function We(e,t=2){return typeof e!="number"||!Number.isFinite(e)?"--":e.toFixed(t)}function Eo(e){return typeof e!="number"||e<0?"--":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function $l(e){if(!e)return"--";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()}function an(e){return typeof e!="number"||!Number.isFinite(e)?"--":new Intl.NumberFormat().format(Math.round(e))}function Bn(e,t){var n;const i=(n=e==null?void 0:e.querySelector)==null?void 0:n.call(e,"[data-value]");if(i){i.textContent=String(t);return}e&&(e.textContent=String(t))}function ls(e,t,i){e&&(e.className=`pill pill--${t}`,e.textContent=i)}function ss(e){const t=y.views.some(i=>i.id===e);c.activeViewId=t?e:"dashboardView";for(const i of y.views){const n=i.id===c.activeViewId;i.classList.toggle("active",n),i.hidden=!n}for(const i of y.menuButtons){const n=i.dataset.view===c.activeViewId;i.classList.toggle("active",n),i.setAttribute("aria-selected",n?"true":"false"),i.tabIndex=n?0:-1}c.activeViewId==="dashboardView"&&c.spectrumPlot&&c.spectrumPlot.resize()}function ju(e){return Lr[e%Lr.length]}function rs(e){if(!e||typeof e!="object")return null;const t=Number(e.widthMm),i=Number(e.aspect),n=Number(e.rimIn);return t>0&&i>=0&&n>0?{widthMm:t,aspect:i,rimIn:n}:null}function Io(e){const t=e.widthMm*(e.aspect/100);return(e.rimIn*25.4+t*2)/1e3}function ki(e,t,i){return Math.min(i,Math.max(t,e))}function Mi(e){return Math.round(e*10)/10}function Sl(...e){let t=0;for(const i of e)typeof i=="number"&&i>0&&(t+=i*i);return Math.sqrt(t)}function Do(e){const t=rs({widthMm:e.tire_width_mm,aspect:e.tire_aspect_pct,rimIn:e.rim_in}),i=t?Io(t)*1e3:700,l=2*Math.max(0,wl.new_tread_mm-wl.worn_tread_mm)*100/Math.max(100,i),o=ki(l/2+wl.safety_margin_pct,.6,2.5),a=.6,g=.2,f=.5,h=Sl(a,o),v=Sl(h,g),m=Sl(v,f),b=ki(2*(h*1.2+1),4,12),M=ki(2*(v*1.2+.9),4,11),S=ki(2*(m*1.2+1),4.5,12);return{wheel_bandwidth_pct:Mi(b),driveshaft_bandwidth_pct:Mi(M),engine_bandwidth_pct:Mi(S),speed_uncertainty_pct:a,tire_diameter_uncertainty_pct:Mi(o),final_drive_uncertainty_pct:g,gear_uncertainty_pct:f,min_abs_band_hz:.4,max_band_half_width_pct:8,band_tolerance_model_version:ri}}function Bo(){if(typeof c.speedMps=="number"&&c.speedMps>0)return c.speedMps;const e=(c.vehicleSettings.speed_override_kmh||0)/3.6;return e>0?e:null}function Vn(){const e=Nu();if(typeof c.speedMps=="number"){const i=Er(c.speedMps);y.speed.textContent=k("speed.gps",{value:We(i,1),unit:e});return}const t=Bo();if(t){const i=Er(t);y.speed.textContent=k("speed.override",{value:We(i,1),unit:e});return}y.speed.textContent=k("speed.none",{unit:e})}function Po(){const t={connecting:"ws.connecting",connected:"ws.connected",reconnecting:"ws.reconnecting",stale:"ws.stale",no_data:"ws.no_data"}[c.wsState]||"ws.connecting",i={connecting:"muted",connected:"ok",reconnecting:"warn",stale:"bad",no_data:"muted"};ls(y.linkState,i[c.wsState]||"muted",k(t))}function oi(){if(y.spectrumOverlay){if(!c.hasReceivedPayload&&c.wsState==="connecting"){y.spectrumOverlay.hidden=!1,y.spectrumOverlay.textContent=k("spectrum.loading");return}if(c.wsState==="connecting"||c.wsState==="reconnecting"){y.spectrumOverlay.hidden=!1,y.spectrumOverlay.textContent=k("ws.connecting");return}if(c.wsState==="stale"){y.spectrumOverlay.hidden=!1,y.spectrumOverlay.textContent=k("spectrum.stale");return}if(!c.hasSpectrumData||c.wsState==="no_data"){y.spectrumOverlay.hidden=!1,y.spectrumOverlay.textContent=k("spectrum.empty");return}y.spectrumOverlay.hidden=!0,y.spectrumOverlay.textContent=""}}function xl(...e){let t=0;for(const i of e)typeof i=="number"&&i>0&&(t+=i*i);return Math.sqrt(t)}function Cn(e,t,i){const n=Math.max(0,Number(e)||0)/200,l=Math.max(0,c.vehicleSettings.min_abs_band_hz||0)/Math.max(1,t),o=Math.max(.005,(c.vehicleSettings.max_band_half_width_pct||0)/100),a=Math.sqrt(n*n+i*i);return Math.min(o,Math.max(a,l))}function zo(){return{hooks:{draw:[e=>{if(!c.chartBands.length)return;const t=e.ctx,i=e.bbox.top,n=e.bbox.height;for(const l of c.chartBands){if(!(l.max_hz>l.min_hz))continue;const o=e.valToPos(l.min_hz,"x",!0),a=e.valToPos(l.max_hz,"x",!0);t.fillStyle=l.color,t.fillRect(o,i,Math.max(1,a-o),n)}}]}}}function Gu(){if(y.bandLegend){if(!c.chartBands.length){y.bandLegend.innerHTML="";return}y.bandLegend.innerHTML="";for(const e of c.chartBands){const t=document.createElement("div");t.className="legend-item",t.innerHTML=`<span class="swatch" style="--swatch-color:${e.color}"></span><span>${e.label}</span>`,y.bandLegend.appendChild(t)}}}function Co(){const e=Bo();if(!(typeof e=="number"&&e>0))return null;const t=rs({widthMm:c.vehicleSettings.tire_width_mm,aspect:c.vehicleSettings.tire_aspect_pct,rimIn:c.vehicleSettings.rim_in});if(!t)return null;const i=e/(Math.PI*Io(t)),n=i*c.vehicleSettings.final_drive_ratio,l=n*c.vehicleSettings.current_gear_ratio,o=Math.max(0,c.vehicleSettings.speed_uncertainty_pct||0)/100,a=Math.max(0,c.vehicleSettings.tire_diameter_uncertainty_pct||0)/100,g=Math.max(0,c.vehicleSettings.final_drive_uncertainty_pct||0)/100,f=Math.max(0,c.vehicleSettings.gear_uncertainty_pct||0)/100,h=xl(o,a),v=xl(h,g),m=xl(v,f);return{wheelHz:i,driveHz:n,engineHz:l,wheelUncertaintyPct:h,driveUncertaintyPct:v,engineUncertaintyPct:m}}function Ku(e){c.spectrumPlot&&(c.spectrumPlot.destroy(),c.spectrumPlot=null),c.spectrumPlot=new Cu(y.specChart,y.spectrumOverlay,360,y.specChartWrap),c.spectrumPlot.ensurePlot(e,{title:k("chart.spectrum_title"),axisHz:k("chart.axis.hz"),axisAmplitude:k("chart.axis.amplitude")},[zo()])}function qu(e){c.spectrumPlot&&c.spectrumPlot.renderLegend(y.legend,e)}function j(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $o(e){const t=String((e==null?void 0:e.name)||"").trim();if(!t)return"";for(const n of c.locationCodes)if(_u(`location.${n}`).some(o=>o===t))return n;const i=c.locationOptions.find(n=>n.label===t);return i?i.code:""}function Yu(e){const t=[`<option value="">${j(k("settings.select_location"))}</option>`];for(const i of c.locationOptions){const n=i.code===e?" selected":"";t.push(`<option value="${j(i.code)}"${n}>${j(i.label)}</option>`)}return t.join("")}function Ju(){const e=c.clients.map(i=>{const n=i.connected?"1":"0";return`${i.id}|${i.name||""}|${i.mac_address||""}|${n}`}).join("||"),t=c.locationOptions.map(i=>`${i.code}|${i.label}`).join("||");return`${e}##${t}`}function ci(e=!1){const t=Ju();!e&&t===c.clientsSettingsSignature||(c.clientsSettingsSignature=t,Qu())}function Oo(){const e=c.selectedClientId,t=c.clients.find(i=>!!i.connected);!c.selectedClientId&&c.clients.length>0&&(c.selectedClientId=t?t.id:c.clients[0].id),e&&c.clients.some(i=>i.id===e)&&(c.selectedClientId=e),c.selectedClientId&&!c.clients.some(i=>i.id===c.selectedClientId)&&(c.selectedClientId=t?t.id:c.clients.length?c.clients[0].id:null)}function Qu(){if(y.clientsSettingsBody){if(!c.clients.length){y.clientsSettingsBody.innerHTML=`<tr><td colspan="5">${j(k("settings.no_clients"))}</td></tr>`;return}y.clientsSettingsBody.innerHTML=c.clients.map(e=>{const t=$o(e),i=!!e.connected,n=k(i?"status.online":"status.offline"),l=i?"online":"offline",o=e.mac_address||e.id;return`
      <tr data-client-id="${j(e.id)}">
        <td>
          <strong>${j(e.name||e.id)}</strong>
          <div class="subtle">${j(e.id)}</div>
          <div class="status-pill ${l}">${n}</div>
        </td>
        <td><code>${j(o)}</code></td>
        <td>
          <select class="row-location-select" data-client-id="${j(e.id)}">
            ${Yu(t)}
          </select>
        </td>
        <td><button class="btn btn--primary row-identify" data-client-id="${j(e.id)}"${i?"":" disabled"}>${j(k("actions.identify"))}</button></td>
        <td><button class="btn btn--danger row-remove" data-client-id="${j(e.id)}">${j(k("actions.remove"))}</button></td>
      </tr>`}).join(""),y.clientsSettingsBody.querySelectorAll(".row-location-select").forEach(e=>{e.addEventListener("change",async()=>{const t=e.getAttribute("data-client-id");if(!t)return;const i=e.value||"";await Bd(t,i)})}),y.clientsSettingsBody.querySelectorAll(".row-identify").forEach(e=>{e.addEventListener("click",async()=>{if(e.hasAttribute("disabled"))return;const t=e.getAttribute("data-client-id");t&&await Pd(t)})}),y.clientsSettingsBody.querySelectorAll(".row-remove").forEach(e=>{e.addEventListener("click",async()=>{const t=e.getAttribute("data-client-id");t&&await zd(t)})})}}function Zu(e){if(!e){Bn(y.lastSeen,"--"),Bn(y.dropped,"--"),Bn(y.framesTotal,"--");return}const t=e.last_seen_age_ms??null,i=c.lang==="nl"?"ms geleden":"ms ago",n=t===null?"--":`${an(Math.max(0,t))} ${i}`;Bn(y.lastSeen,n),Bn(y.dropped,an(e.dropped_frames??0)),Bn(y.framesTotal,an(e.frames_total??0))}async function os(e){const t=typeof e=="number"&&e>0?e:null;try{const i=await Su(t);typeof(i==null?void 0:i.speed_kmh)=="number"&&(c.vehicleSettings.speed_override_kmh=i.speed_kmh,y.speedOverrideInput.value=String(i.speed_kmh))}catch{}}async function Xu(){try{const e=await wu();typeof(e==null?void 0:e.speed_kmh)=="number"&&(c.vehicleSettings.speed_override_kmh=e.speed_kmh,is(),To(),Vn())}catch{}}async function Ro(){const e={tire_width_mm:c.vehicleSettings.tire_width_mm,tire_aspect_pct:c.vehicleSettings.tire_aspect_pct,rim_in:c.vehicleSettings.rim_in,final_drive_ratio:c.vehicleSettings.final_drive_ratio,current_gear_ratio:c.vehicleSettings.current_gear_ratio};try{await xu(e)}catch{}}function Fi(){const e=c.loggingStatus||{enabled:!1,current_file:null},t=!!e.enabled;ls(y.loggingStatus,t?"ok":"muted",k(t?"status.running":"status.stopped")),y.currentLogFile.textContent=k("status.current_file",{value:e.current_file||"--"})}async function ed(){try{c.loggingStatus=await ku(),Fi()}catch{ls(y.loggingStatus,"bad",k("status.unavailable"))}}function td(){c.eventMatrix=ns(),c.recentDetectionEvents=[],c.lastDetectionByClient={},c.lastDetectionGlobal={},Vi()}async function nd(){try{c.loggingStatus=await Mu(),td(),Fi(),await ui()}catch{}}async function id(){try{c.loggingStatus=await Lu(),Fi(),await ui()}catch{}}function Ui(e){return c.logDetailsByName[e]||(c.logDetailsByName[e]={preview:null,previewLoading:!1,previewError:"",insights:null,insightsLoading:!1,insightsError:"",pdfLoading:!1,pdfError:""}),c.logDetailsByName[e]}function ai(){const e=c.expandedLogName;c.expandedLogName=null,e&&delete c.logDetailsByName[e]}function ld(e){const t=String(e||"").toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim();return t?t.includes("front left")&&t.includes("wheel")?"front-left wheel":t.includes("front right")&&t.includes("wheel")?"front-right wheel":t.includes("rear left")&&t.includes("wheel")?"rear-left wheel":t.includes("rear right")&&t.includes("wheel")?"rear-right wheel":t.includes("engine")?"engine bay":t.includes("drive")&&t.includes("tunnel")?"driveshaft tunnel":t.includes("driver")&&t.includes("seat")?"driver seat":t.includes("trunk")?"trunk":t:""}function sd(e,t,i){return typeof e!="number"||!Number.isFinite(e)?0:typeof t!="number"||typeof i!="number"||i<=t?1:Math.max(0,Math.min(1,(e-t)/(i-t)))}function rd(e){return`hsl(${Math.round(212-e*190)} 76% 48%)`}function od(e){return!e||typeof e!="object"?null:Number(e.p95_intensity_g??e.p95??e.mean_intensity_g??e.max_intensity_g)||null}function ad(e){return(Array.isArray(e==null?void 0:e.findings)?e.findings:[]).slice(0,3)}function cd(e){const t=[{key:"front-left wheel",top:23,left:20},{key:"front-right wheel",top:23,left:80},{key:"rear-left wheel",top:76,left:20},{key:"rear-right wheel",top:76,left:80},{key:"engine bay",top:30,left:50},{key:"driveshaft tunnel",top:51,left:50},{key:"driver seat",top:43,left:40},{key:"trunk",top:86,left:50}],i=Array.isArray(e==null?void 0:e.sensor_intensity_by_location)?e.sensor_intensity_by_location:[],n={};for(const f of i){const h=ld(f==null?void 0:f.location),v=od(f);h&&typeof v=="number"&&Number.isFinite(v)&&(n[h]=v)}const l=Object.values(n).filter(f=>typeof f=="number"),o=l.length?Math.min(...l):null,a=l.length?Math.max(...l):null,g=t.map(f=>{const h=n[f.key],v=typeof h=="number"&&Number.isFinite(h),m=sd(h,o,a),b=v?rd(m):"var(--md-sys-color-outline-variant)",M=v?`${We(h,4)} g`:k("logs.not_available");return`<div class="mini-car-dot${v?"":" mini-car-dot--muted"}" style="top:${f.top}%;left:${f.left}%;background:${b}" title="${j(f.key)}: ${j(M)}"></div>`}).join("");return`
      <div class="mini-car-wrap">
        <div class="mini-car-title">${j(k("logs.preview_heatmap_title"))}</div>
        <div class="mini-car">${g}</div>
      </div>
    `}function ud(e){const t=Array.isArray(e==null?void 0:e.sensor_intensity_by_location)?e.sensor_intensity_by_location:[];if(!t.length)return`<p class="subtle">${j(k("logs.preview_unavailable"))}</p>`;const i=t.map(n=>{const l=(n==null?void 0:n.dropped_frames_delta)??(n==null?void 0:n.frames_dropped_delta),o=n==null?void 0:n.queue_overflow_drops_delta;return`
          <tr>
            <td>${j(n.location||"--")}</td>
            <td class="numeric">${We(n.p50_intensity_g??n.p50,4)}</td>
            <td class="numeric">${We(n.p95_intensity_g??n.p95,4)}</td>
            <td class="numeric">${We(n.max_intensity_g,4)}</td>
            <td class="numeric">${typeof l=="number"?an(l):"--"}</td>
            <td class="numeric">${typeof o=="number"?an(o):"--"}</td>
            <td class="numeric">${an(n.sample_count??n.samples)}</td>
          </tr>`}).join("");return`
      <div class="logs-preview-stats">
        <div class="mini-car-title">${j(k("logs.preview_stats_title"))}</div>
        <table class="logs-preview-table">
          <thead>
            <tr>
              <th>${j(k("logs.table.location"))}</th>
              <th class="numeric">p50</th>
              <th class="numeric">p95</th>
              <th class="numeric">max</th>
              <th class="numeric">${j(k("logs.table.dropped_delta"))}</th>
              <th class="numeric">${j(k("logs.table.overflow_delta"))}</th>
              <th class="numeric">${j(k("logs.table.samples"))}</th>
            </tr>
          </thead>
          <tbody>${i}</tbody>
        </table>
      </div>
    `}function dd(e){const t=ad(e.insights),i=e.insights?k("logs.reload_insights"):k("logs.load_insights"),n=e.insightsLoading,l=t.length?t.map(o=>{const a=(o==null?void 0:o.suspected_source)||k("report.missing"),g=typeof(o==null?void 0:o.confidence_0_to_1)=="number"?We(o.confidence_0_to_1,2):"--";return`<li><strong>${j(a)}</strong> (${j(k("report.confidence",{value:g}))}) - ${j((o==null?void 0:o.evidence_summary)||"")}</li>`}).join(""):`<li>${j(k("report.no_findings_for_run"))}</li>`;return`
      <div class="logs-insights-block">
        <div class="logs-insights-actions">
          <button class="btn btn--primary" data-log-action="load-insights" ${n?"disabled":""}>${j(n?k("logs.loading_insights"):i)}</button>
          ${e.insightsError?`<span class="logs-inline-error">${j(e.insightsError)}</span>`:""}
        </div>
        ${e.insights?`<ul class="logs-findings-list">${l}</ul>`:""}
      </div>
    `}function fd(e,t){if(!t)return"";const i=t.preview,n=i?[`${k("report.file")}: ${e.name}`,`${k("logs.summary_created")}: ${$l(i.start_time_utc)}`,`${k("logs.summary_updated")}: ${$l(e.updated_at)}`,`${k("logs.summary_size")}: ${Eo(e.size_bytes)}`,`${k("report.duration")}: ${We(i.duration_s,1)} s`,`${k("logs.summary_sensor_count")}: ${an(i.sensor_count_used)}`].join("  "):"";let l="";return t.previewLoading?l=`<p class="subtle">${j(k("logs.loading_preview"))}</p>`:t.previewError?l=`<p class="logs-inline-error">${j(t.previewError)}</p>`:i?l=`
        <div class="logs-details-preview">
          ${cd(i)}
          ${ud(i)}
        </div>
      `:l=`<p class="subtle">${j(k("logs.preview_unavailable"))}</p>`,`
      <tr class="logs-details-row">
        <td colspan="4">
          <div class="logs-details-card">
            ${n?`<div class="logs-run-summary">${j(n)}</div>`:""}
            ${l}
            ${dd(t)}
          </div>
        </td>
      </tr>
    `}function Mt(){if(!c.logs.length){y.logsSummary.textContent=k("logs.none"),y.logsTableBody.innerHTML=`<tr><td colspan="4">${j(k("logs.none_found"))}</td></tr>`,ai();return}c.expandedLogName&&!c.logs.some(t=>t.name===c.expandedLogName)&&ai(),y.logsSummary.textContent=k("logs.available_count",{count:c.logs.length});const e=[];for(const t of c.logs){const i=Ui(t.name),n=i.pdfLoading?k("logs.generating_pdf"):k("logs.generate_pdf"),l=i.pdfError?`<div class="logs-inline-error">${j(i.pdfError)}</div>`:"";e.push(`
        <tr class="logs-row${c.expandedLogName===t.name?" logs-row--expanded":""}" data-log-row="1" data-log="${j(t.name)}">
          <td>${j(t.name)}</td>
          <td>${$l(t.updated_at)}</td>
          <td class="numeric">${Eo(t.size_bytes)}</td>
          <td>
            <div class="table-actions">
              <button class="btn btn--success" data-log-action="download-pdf" data-log="${j(t.name)}" ${i.pdfLoading?"disabled":""}>${j(n)}</button>
              <a class="btn btn--muted" href="${vu(t.name)}" download="${j(t.name)}" data-log-action="download-raw" data-log="${j(t.name)}">${j(k("logs.raw"))}</a>
              <button class="btn btn--danger" data-log-action="delete-log" data-log="${j(t.name)}">${j(k("logs.delete"))}</button>
            </div>
            ${l}
          </td>
        </tr>`),c.expandedLogName===t.name&&e.push(fd(t,i))}y.logsTableBody.innerHTML=e.join("")}async function gd(){try{const e=await yu(),t=Array.isArray(e.locations)?e.locations.map(i=>i==null?void 0:i.code).filter(i=>typeof i=="string"):[];c.locationCodes=t.length?t:zl.slice(),c.locationOptions=Cl(c.locationCodes)}catch{c.locationCodes=zl.slice(),c.locationOptions=Cl(c.locationCodes)}ci(!0)}async function ui(){try{const e=await Au();c.logs=Array.isArray(e.logs)?e.logs:[],Mt()}catch{c.logs=[],Mt()}}async function hd(e){if(!(!e||!window.confirm(k("logs.delete_confirm",{name:e})))){try{await Tu(e)}catch(i){window.alert((i==null?void 0:i.message)||k("logs.delete_failed"));return}c.expandedLogName===e&&ai(),await ui()}}async function No(e,t=!1){if(!e)return;const i=Ui(e);if(!(!t&&(i.previewLoading||i.preview))){i.previewLoading=!0,i.previewError="",Mt();try{i.preview=await wo(e,c.lang,!1)}catch(n){i.previewError=(n==null?void 0:n.message)||k("report.unable_load_insights")}finally{i.previewLoading=!1,Mt()}}}async function Ho(e,t=!1){if(!e)return;const i=Ui(e);if(!(!t&&i.insightsLoading)){i.insightsLoading=!0,i.insightsError="",Mt();try{i.insights=await wo(e,c.lang,!1)}catch(n){i.insightsError=(n==null?void 0:n.message)||k("report.unable_load_insights")}finally{i.insightsLoading=!1,Mt()}}}function pd(e,t){if(!e)return t;const i=e.match(/filename\*=UTF-8''([^;]+)/i);if(i&&i[1])return decodeURIComponent(i[1]);const n=e.match(/filename="?([^";]+)"?/i);return n&&n[1]?n[1]:t}async function md(e,t){const i=await fetch(e);if(!i.ok){let g=`${i.status} ${i.statusText}`;try{const f=await i.json();f&&typeof f.detail=="string"&&(g=f.detail)}catch{}throw new Error(g)}const n=await i.blob(),l=pd(i.headers.get("content-disposition"),t||"download.bin"),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=l,document.body.appendChild(a),a.click(),a.remove(),setTimeout(()=>URL.revokeObjectURL(o),0)}async function _d(e){const t=Ui(e);if(!t.pdfLoading){t.pdfLoading=!0,t.pdfError="",Mt();try{await md(bu(e,c.lang),`${e.replace(/\.jsonl$/i,"")}_report.pdf`)}catch(i){t.pdfError=(i==null?void 0:i.message)||k("logs.pdf_failed")}finally{t.pdfLoading=!1,Mt()}}}function vd(e){if(e){if(c.expandedLogName===e){ai(),Mt();return}ai(),c.expandedLogName=e,Mt(),No(e)}}async function bd(e,t){if(!(!e||!t)){if(e==="download-pdf"){await _d(t);return}if(e==="delete-log"){await hd(t);return}e==="load-insights"&&await Ho(t,!0)}}function yd(){const e=Co();if(!e)return[];const{wheelHz:t,driveHz:i,engineHz:n,wheelUncertaintyPct:l,driveUncertaintyPct:o,engineUncertaintyPct:a}=e,g=(M,S,T,$)=>({label:M,min_hz:Math.max(0,S*(1-T)),max_hz:S*(1+T),color:$}),f=Cn(c.vehicleSettings.wheel_bandwidth_pct,t,l),h=Cn(c.vehicleSettings.driveshaft_bandwidth_pct,i,o),v=Cn(c.vehicleSettings.engine_bandwidth_pct,n,a),m=[g(k("bands.wheel_1x"),t,f,Dn.wheel1),g(k("bands.wheel_2x"),t*2,f,Dn.wheel2)],b=Math.max(.03,o+a);return Math.abs(i-n)/Math.max(1e-6,n)<b?m.push(g(k("bands.driveshaft_engine_1x"),i,Math.max(h,v),Dn.driveshaftEngine1)):(m.push(g(k("bands.driveshaft_1x"),i,h,Dn.driveshaft1)),m.push(g(k("bands.engine_1x"),n,v,Dn.engine1))),m.push(g(k("bands.engine_2x"),n*2,v,Dn.engine2)),m}function Ol(e){c.vibrationMessages.unshift({ts:new Date().toLocaleTimeString(),text:e}),c.vibrationMessages=c.vibrationMessages.slice(0,80),Fo()}function Fo(){if(!c.vibrationMessages.length){y.vibrationLog.innerHTML=`<div class="log-row">${j(k("vibration.none"))}</div>`;return}y.vibrationLog.innerHTML=c.vibrationMessages.map(e=>`<div class="log-row"><div class="log-time">${e.ts}</div>${e.text}</div>`).join("")}function wd(e){const t=Co(),i=[];if(t){const{wheelHz:o,driveHz:a,engineHz:g,wheelUncertaintyPct:f,driveUncertaintyPct:h,engineUncertaintyPct:v}=t,m=Cn(c.vehicleSettings.wheel_bandwidth_pct,o,f),b=Cn(c.vehicleSettings.driveshaft_bandwidth_pct,a,h),M=Cn(c.vehicleSettings.engine_bandwidth_pct,g,v);i.push({cause:k("cause.wheel1"),hz:o,tol:m,key:"wheel1"}),i.push({cause:k("cause.wheel2"),hz:o*2,tol:m,key:"wheel2"});const S=Math.max(.03,h+v);Math.abs(a-g)/Math.max(1e-6,g)<S?i.push({cause:k("cause.shaft_eng1"),hz:a,tol:Math.max(b,M),key:"shaft_eng1"}):(i.push({cause:k("cause.shaft1"),hz:a,tol:b,key:"shaft1"}),i.push({cause:k("cause.eng1"),hz:g,tol:M,key:"eng1"})),i.push({cause:k("cause.eng2"),hz:g*2,tol:M,key:"eng2"})}let n=null,l=Number.POSITIVE_INFINITY;for(const o of i){if(!(o.hz>.2))continue;const a=Math.abs(e-o.hz)/o.hz;a<=o.tol&&a<l&&(n=o,l=a)}return n||(e>=3&&e<=12?{cause:k("cause.road"),key:"road"}:{cause:k("cause.other"),key:"other"})}function Sd(e,t){const i=Math.max(0,Number(e)||0),n=Math.max(0,Number(t)||0),l=Math.max(.001,Number(c.vehicleSettings.event_db_floor_eps_ratio)||.05),o=Math.max(1e-6,Number(c.vehicleSettings.event_min_abs_peak_g)||.01),a=Math.max(o*.05,n*l);return Math.max(0,20*Math.log10((i+a)/(n+a)))}function xd(e,t,i){const n=c.eventMatrix[e];if(!n)return;const l=n[t];l&&(l.count+=1,l.contributors[i]=(l.contributors[i]||0)+1)}function Ir(e,t,i){for(const n of e)xd(n,t,i)}function Dr(e,t){var g;const i=Di.find(f=>f.key===e),n=c.strengthBands.find(f=>f.key===t),l=(g=c.eventMatrix[e])==null?void 0:g[t];if(!l||l.count===0)return`${k((i==null?void 0:i.labelKey)||e)} / ${k((n==null?void 0:n.labelKey)||t)}
${k("tooltip.no_events")}`;const o=[`${k((i==null?void 0:i.labelKey)||e)} / ${k((n==null?void 0:n.labelKey)||t)}`,k("tooltip.total_events",{count:l.count}),`Seconds: ${We(l.seconds||0,1)}`],a=Object.entries(l.contributors).sort((f,h)=>h[1]-f[1]);if(a.length){o.push(k("tooltip.by_sensor_scope"));for(const[f,h]of a)o.push(`- ${f}: ${h}`)}return o.join(`
`)}function Br(e,t,i){if(!y.matrixTooltip)return;y.matrixTooltip.textContent=e,y.matrixTooltip.style.display="block";const n=12,l=window.innerWidth,o=window.innerHeight,a=y.matrixTooltip.getBoundingClientRect();let g=t+n,f=i+n;g+a.width>l-8&&(g=Math.max(8,t-a.width-n)),f+a.height>o-8&&(f=Math.max(8,i-a.height-n)),y.matrixTooltip.style.left=`${g}px`,y.matrixTooltip.style.top=`${f}px`}function Rl(){y.matrixTooltip&&(y.matrixTooltip.style.display="none")}function kd(){if(!y.vibrationMatrix)return;const e=y.vibrationMatrix.querySelectorAll(".vib-cell");for(const t of e){const i=t.getAttribute("data-source"),n=t.getAttribute("data-severity");!i||!n||(t.addEventListener("mouseenter",l=>{const o=Dr(i,n);Br(o,l.clientX,l.clientY)}),t.addEventListener("mousemove",l=>{const o=Dr(i,n);Br(o,l.clientX,l.clientY)}),t.addEventListener("mouseleave",Rl),t.addEventListener("blur",Rl))}}function Vi(){if(!y.vibrationMatrix)return;Rl();const e=`<thead><tr><th>${j(k("matrix.amplitude_group"))}</th>${Di.map(i=>`<th>${j(k(i.labelKey))}</th>`).join("")}</tr></thead>`,t=[...c.strengthBands].sort((i,n)=>n.min_db-i.min_db).map(i=>{const n=Di.map(l=>{const o=c.eventMatrix[l.key][i.key].count;return`<td class="vib-cell" data-source="${l.key}" data-severity="${i.key}">${o}</td>`}).join("");return`<tr><td>${j(k(i.labelKey))}</td>${n}</tr>`}).join("");y.vibrationMatrix.innerHTML=`${e}<tbody>${t}</tbody>`,kd()}function Md(e){c.strengthBands=ts(e.strength_bands),e.matrix?c.eventMatrix=e.matrix:c.eventMatrix=ns(c.strengthBands),Vi();const t=Array.isArray(e.events)?e.events:[];if(t.length)for(const l of t.slice(0,6)){const o=Array.isArray(l.sensor_labels)?l.sensor_labels.join(", "):l.sensor_label||"--";Ol(`Strength ${String(l.severity_key||"l1").toUpperCase()} (${We(l.severity_db||0,1)} dB) @ ${We(l.peak_hz||0,2)} Hz | ${o} | ${l.class_key||"other"}`)}const n=(e.levels||{}).by_source||{};Ad(n)}function Bi(){const e=c.strengthBands;if(!e.length)return[0,50];const t=Math.max(0,Math.floor(Math.min(...e.map(n=>n.min_db))-4)),i=Math.ceil(Math.max(...e.map(n=>n.min_db))+10);return[t,i]}function Ld(){if(!y.strengthChart||c.strengthPlot)return;const e={hooks:{drawClear:[i=>{const n=i.ctx,l=[...c.strengthBands].sort((o,a)=>o.min_db-a.min_db);for(let o=0;o<l.length;o++){const a=l[o],g=o+1<l.length?l[o+1].min_db:Bi()[1],f=i.valToPos(g,"y",!0),h=i.valToPos(a.min_db,"y",!0);n.fillStyle=`hsla(${220-o*35}, 70%, 55%, 0.08)`,n.fillRect(i.bbox.left,f,i.bbox.width,h-f),n.strokeStyle="rgba(79,93,115,0.28)",n.beginPath(),n.moveTo(i.bbox.left,h),n.lineTo(i.bbox.left+i.bbox.width,h),n.stroke(),n.fillStyle="#4f5d73",n.font="11px Segoe UI",n.fillText(a.key.toUpperCase(),i.bbox.left+i.bbox.width+8,h+4)}}],setCursor:[i=>{var a;const n=(a=i.cursor)==null?void 0:a.idx;if(n==null||n<0){y.strengthTooltip&&(y.strengthTooltip.style.display="none");return}const o=["wheel","driveshaft","engine","other"].map((g,f)=>{var h;return`${g}: ${We(((h=i.data[f+1])==null?void 0:h[n])||0,1)} dB`});y.strengthTooltip&&(y.strengthTooltip.textContent=o.join(`
`),y.strengthTooltip.style.display="block")}]}};c.strengthPlot=new Ue({title:"Strength over time",width:Math.max(320,Math.floor(y.strengthChart.getBoundingClientRect().width||320)),height:240,scales:{x:{time:!1},y:{range:Bi()}},axes:[{label:"s"},{label:"Strength (dB over floor)"}],series:[{label:"t"},{label:"wheel",stroke:"#2563eb",width:2},{label:"driveshaft",stroke:"#14b8a6",width:2},{label:"engine",stroke:"#f59e0b",width:2},{label:"other",stroke:"#8b5cf6",width:2}],plugins:[e]},[[],[],[],[],[]],y.strengthChart);const t=()=>{!c.strengthPlot||!y.strengthChart||c.strengthPlot.setSize({width:Math.max(320,Math.floor(y.strengthChart.getBoundingClientRect().width||320)),height:240})};window.addEventListener("resize",t),document.addEventListener("visibilitychange",()=>{document.hidden||t()})}function Ad(e){if(Ld(),!c.strengthPlot)return;const t=Date.now()/1e3;c.strengthHistory.t.push(t);for(const o of["wheel","driveshaft","engine","other"]){const a=e==null?void 0:e[o];c.strengthHistory[o].push((a==null?void 0:a.strength_db)||0)}const i=60;for(;c.strengthHistory.t.length&&t-c.strengthHistory.t[0]>i;)c.strengthHistory.t.shift(),c.strengthHistory.wheel.shift(),c.strengthHistory.driveshaft.shift(),c.strengthHistory.engine.shift(),c.strengthHistory.other.shift();const n=c.strengthHistory.t[0]||t,l=c.strengthHistory.t.map(o=>o-n);c.strengthPlot.setScale("y",{min:Bi()[0],max:Bi()[1]}),c.strengthPlot.setData([l,c.strengthHistory.wheel,c.strengthHistory.driveshaft,c.strengthHistory.engine,c.strengthHistory.other])}function Pr(e,t){for(const n of e)c.recentDetectionEvents.push({ts:t,sensorId:n.sensorId,sensorLabel:n.sensorLabel,peakHz:n.peakHz,peakAmp:n.peakAmp,floorAmp:n.floorAmp,cls:n.cls});const i=t-Pu;c.recentDetectionEvents=c.recentDetectionEvents.filter(n=>n.ts>=i)}function Td(){const e=new Map;for(const t of c.recentDetectionEvents){const i=Math.round(t.peakHz/zu),n=`${t.cls.key}:${i}`;e.has(n)||e.set(n,new Map);const l=e.get(n),o=l.get(t.sensorId);(!o||t.ts>o.ts)&&l.set(t.sensorId,t)}return e}function Wi(){var g;const e=Array.isArray(c.spectra.freq)?c.spectra.freq:[],t=[];let i=[];function n(f,h,v){if(!Array.isArray(f)||!Array.isArray(h))return[];if(!Array.isArray(v)||!v.length)return h.slice();if(f.length!==h.length||f.length<2)return[];const m=new Array(v.length);let b=0;for(let M=0;M<v.length;M++){const S=v[M];for(;b+1<f.length&&f[b+1]<S;)b++;if(b+1>=f.length){m[M]=h[h.length-1];continue}const T=f[b],$=f[b+1],F=h[b],L=h[b+1];if($<=T){m[M]=F;continue}const O=(S-T)/($-T);m[M]=F+(L-F)*O}return m}for(const[f,h]of c.clients.entries()){const v=(g=c.spectra.clients)==null?void 0:g[h.id];if(!v||!Array.isArray(v.x)||!Array.isArray(v.y)||!Array.isArray(v.z))continue;const m=Array.isArray(v.freq)&&v.freq.length?v.freq:e,b=Math.min(m.length,v.x.length,v.y.length,v.z.length);if(!b)continue;let M=new Array(b);for(let T=0;T<b;T++)M[T]=Math.sqrt((v.x[T]*v.x[T]+v.y[T]*v.y[T]+v.z[T]*v.z[T])/3);const S=m.slice(0,b);i.length?(S.length!==i.length||S.some((T,$)=>Math.abs(T-i[$])>1e-6))&&(M=n(S,M,i)):i=S,M.length&&t.push({id:h.id,label:h.name||h.id,color:ju(f),values:M})}if(!c.spectrumPlot||c.spectrumPlot.getSeriesCount()!==t.length+1?Ku(t):c.spectrumPlot.ensurePlot(t,{title:k("chart.spectrum_title"),axisHz:k("chart.axis.hz"),axisAmplitude:k("chart.axis.amplitude")},[zo()]),qu(t),c.chartBands=yd(),Gu(),!i.length||!t.length){c.hasSpectrumData=!1,c.spectrumPlot.setData([[],...t.map(()=>[])]),oi();return}const l=Math.min(i.length,...t.map(f=>f.values.length)),o=[i.slice(0,l)];for(const f of t)o.push(f.values.slice(0,l));const a=[o[0]];for(let f=1;f<o.length;f++){const h=o[f],v=h.slice(5).sort((m,b)=>m-b)[Math.floor(Math.max(1,h.length-5)/2)]||0;a.push(h.map(m=>Sd(m,v)))}c.hasSpectrumData=!0,c.spectrumPlot.setData(a),oi(),c.useServerDiagnostics||Ed(o,t)}function Ed(e,t){const i=e[0]||[];if(!i.length)return;const n=[];for(let g=0;g<t.length;g++){const f=e[g+1];if(!Array.isArray(f)||f.length<10)continue;const h=f.slice(5).sort((S,T)=>S-T)[Math.floor(Math.max(1,f.length-5)/2)]||0,v=[];for(let S=2;S<f.length-2;S++)f[S]>f[S-1]&&f[S]>=f[S+1]&&v.push(S);v.sort((S,T)=>f[T]-f[S]);const m=[],b=Math.max(0,Number(c.vehicleSettings.event_min_abs_peak_g)||.01),M=Math.max(1.05,Number(c.vehicleSettings.event_peak_floor_ratio)||3);for(const S of v){if(m.length>=4)break;f[S]<=Math.max(b,h*M)||m.some(T=>Math.abs(i[T]-i[S])<1.2)||m.push(S)}for(const S of m){const T=f[S],$=i[S],F=wd($);n.push({sensorId:t[g].id,sensorLabel:t[g].label,peakHz:$,peakAmp:T,floorAmp:h,cls:F})}}const l=Date.now();if(!n.length){Pr([],l);return}Pr(n,l);const o=new Set,a=Td();for(const[g,f]of a.entries()){const h=Array.from(f.values());if(h.length<2)continue;let v=0,m=0,b=0;const M=[];for(const E of h)o.add(E.sensorId),v+=E.peakHz,m+=E.peakAmp,b+=E.floorAmp,M.push(E.sensorLabel);const S=v/h.length,T=m/h.length,$=b/h.length,F=c.lastDetectionGlobal[g];if(F&&l-F.ts<3e3&&Math.abs(F.hz-S)<1.2)continue;c.lastDetectionGlobal[g]={ts:l,hz:S};const L=Tr(T,$,h.length,c.strengthBands);if(!L)continue;const O=Ar(h[0].cls.key);Ir(O,L.key,`combined(${M.join(", ")})`),Ol(k("msg.multi_detected",{count:h.length,labels:M.join(", "),hz:We(S,2),amp:We(T,1),severity:k(L.labelKey),cause:h[0].cls.cause}))}for(const g of n){if(o.has(g.sensorId))continue;const f=`${g.sensorId}:${g.cls.key}`,h=c.lastDetectionByClient[f];if(h&&l-h.ts<3500&&Math.abs(h.hz-g.peakHz)<1)continue;c.lastDetectionByClient[f]={ts:l,hz:g.peakHz};const v=Tr(g.peakAmp,g.floorAmp,1,c.strengthBands);if(!v)continue;const m=Ar(g.cls.key);Ir(m,v.key,g.sensorLabel),Ol(k("msg.single_detected",{sensor:g.sensorLabel,hz:We(g.peakHz,2),amp:We(g.peakAmp,1),severity:k(v.labelKey),cause:g.cls.cause}))}Vi()}function as(){c.ws&&c.ws.send({client_id:c.selectedClientId})}function Id(){const e=window.location.protocol==="https:"?"wss:":"ws:";c.ws=new Ou({url:`${e}//${window.location.host}/ws`,staleAfterMs:3e3,onPayload:t=>{c.hasReceivedPayload=!0,c.pendingPayload=t,Uo()},onStateChange:t=>{c.wsState=t,Po(),oi(),(t==="connected"||t==="no_data")&&as()}}),c.ws.connect()}function Uo(){c.renderQueued||(c.renderQueued=!0,window.requestAnimationFrame(()=>{c.renderQueued=!1;const e=Date.now();if(e-c.lastRenderTsMs<c.minRenderIntervalMs){Uo();return}const t=c.pendingPayload;t&&(c.pendingPayload=null,c.lastRenderTsMs=e,Dd(t))}))}function Dd(e){var n;const t=c.selectedClientId;if(c.clients=e.clients||[],e.spectra&&(c.spectra=e.spectra),Oo(),ci(),t!==c.selectedClientId&&as(),typeof e.speed_mps=="number"?c.speedMps=e.speed_mps:c.speedMps=null,e.spectra){const l=((n=e==null?void 0:e.spectra)==null?void 0:n.clients)||{},o=Object.values(l);c.hasSpectrumData=o.some(a=>{const g=Array.isArray(a==null?void 0:a.freq)?a.freq.length:0,f=Array.isArray(a==null?void 0:a.x)?a.x.length:0,h=Array.isArray(a==null?void 0:a.y)?a.y.length:0,v=Array.isArray(a==null?void 0:a.z)?a.z.length:0;return g>0&&(f>0||h>0||v>0)})}e.diagnostics&&typeof e.diagnostics=="object"?(Md(e.diagnostics),c.useServerDiagnostics=!0):c.useServerDiagnostics=!1,Vn(),e.spectra?Wi():oi();const i=c.clients.find(l=>l.id===c.selectedClientId);Zu(i)}async function Bd(e,t){if(!e||!t)return;const i=c.clients.find(l=>l.id===e);if(i&&$o(i)===t)return;try{await Eu(e,t)}catch(l){window.alert((l==null?void 0:l.message)||k("actions.set_location_failed"));return}const n=c.locationOptions.find(l=>l.code===t);if(n){const l=c.clients.find(o=>o.id===e);l&&(l.name=n.label),ci()}}async function Pd(e){e&&await Iu(e,1500)}async function zd(e){if(!e||!window.confirm(k("actions.remove_client_confirm",{id:e})))return;try{await Du(e)}catch(n){window.alert((n==null?void 0:n.message)||k("actions.remove_client_failed"));return}const i=c.selectedClientId;c.clients=c.clients.filter(n=>n.id!==e),c.selectedClientId===e&&(c.selectedClientId=null),Oo(),ci(),i!==c.selectedClientId&&as()}function Cd(){const e=rs({widthMm:Number(y.tireWidthInput.value),aspect:Number(y.tireAspectInput.value),rimIn:Number(y.rimInput.value)}),t=Number(y.finalDriveInput.value),i=Number(y.gearRatioInput.value),n=Number(y.wheelBandwidthInput.value),l=Number(y.driveshaftBandwidthInput.value),o=Number(y.engineBandwidthInput.value),a=Number(y.speedUncertaintyInput.value),g=Number(y.tireDiameterUncertaintyInput.value),f=Number(y.finalDriveUncertaintyInput.value),h=Number(y.gearUncertaintyInput.value),v=Number(y.minAbsBandHzInput.value),m=Number(y.maxBandHalfWidthInput.value),b=Number(y.speedOverrideInput.value),M=n>0&&n<=40&&l>0&&l<=40&&o>0&&o<=40,S=a>=0&&a<=20&&g>=0&&g<=20&&f>=0&&f<=10&&h>=0&&h<=20,T=v>=0&&v<=10&&m>0&&m<=25;!e||!(t>0&&i>0)||!(b>=0)||!M||!S||!T||(c.vehicleSettings.tire_width_mm=e.widthMm,c.vehicleSettings.tire_aspect_pct=e.aspect,c.vehicleSettings.rim_in=e.rimIn,c.vehicleSettings.final_drive_ratio=t,c.vehicleSettings.current_gear_ratio=i,c.vehicleSettings.wheel_bandwidth_pct=n,c.vehicleSettings.driveshaft_bandwidth_pct=l,c.vehicleSettings.engine_bandwidth_pct=o,c.vehicleSettings.speed_uncertainty_pct=a,c.vehicleSettings.tire_diameter_uncertainty_pct=g,c.vehicleSettings.final_drive_uncertainty_pct=f,c.vehicleSettings.gear_uncertainty_pct=h,c.vehicleSettings.min_abs_band_hz=v,c.vehicleSettings.max_band_half_width_pct=m,c.vehicleSettings.band_tolerance_model_version=ri,c.vehicleSettings.speed_override_kmh=b,is(),Ro(),os(c.vehicleSettings.speed_override_kmh),Wi(),Vn())}function Vo(){const e=Number(y.speedOverrideInput.value);e>=0&&(c.vehicleSettings.speed_override_kmh=e,is(),os(c.vehicleSettings.speed_override_kmh),Wi(),Vn())}function Li(e){if(!y.menuButtons.length)return;const t=(e%y.menuButtons.length+y.menuButtons.length)%y.menuButtons.length,i=y.menuButtons[t],n=i.dataset.view;n&&(ss(n),i.focus())}y.menuButtons.forEach((e,t)=>{const i=()=>{const n=e.dataset.view;n&&ss(n)};e.addEventListener("click",i),e.addEventListener("keydown",n=>{if(n.key==="Enter"||n.key===" "){n.preventDefault(),i();return}if(n.key==="ArrowRight"){n.preventDefault(),Li(t+1);return}if(n.key==="ArrowLeft"){n.preventDefault(),Li(t-1);return}if(n.key==="Home"){n.preventDefault(),Li(0);return}n.key==="End"&&(n.preventDefault(),Li(y.menuButtons.length-1))})});y.startLoggingBtn.addEventListener("click",nd);y.stopLoggingBtn.addEventListener("click",id);y.refreshLogsBtn.addEventListener("click",ui);y.logsTableBody.addEventListener("click",e=>{var l,o;const t=e.target,i=(l=t==null?void 0:t.closest)==null?void 0:l.call(t,"[data-log-action]");if(i){const a=i.getAttribute("data-log-action"),g=i.getAttribute("data-log")||c.expandedLogName||"";a!=="download-raw"&&e.preventDefault(),e.stopPropagation(),bd(a,g);return}const n=(o=t==null?void 0:t.closest)==null?void 0:o.call(t,'tr[data-log-row="1"]');if(n){const a=n.getAttribute("data-log")||"";vd(a)}});y.applySpeedOverrideBtn&&y.applySpeedOverrideBtn.addEventListener("click",Vo);y.languageSelect&&(y.languageSelect.value=c.lang,y.languageSelect.addEventListener("change",()=>{Vu(y.languageSelect.value),Ao(!0)}));y.speedUnitSelect&&(y.speedUnitSelect.value=c.speedUnit,y.speedUnitSelect.addEventListener("change",()=>{Ru(y.speedUnitSelect.value),Vn()}));y.speedOverrideInput.addEventListener("keydown",e=>{e.key==="Enter"&&(e.preventDefault(),Vo())});y.saveSettingsBtn.addEventListener("click",Cd);Wu();To();Ao(!1);ss("dashboardView");gd();Xu();Ro();os(c.vehicleSettings.speed_override_kmh);ed();ui();Id();
